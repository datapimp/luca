(function(){var e,t=Array.prototype.slice;(window||global).Luca=function(){var e,n,r,i,s,o;s=arguments[0],e=2<=arguments.length?t.call(arguments,1):[];if(_.isString(s)&&(o=Luca.cache(s)))return o;if(_.isString(s)&&(o=Luca.find(s)))return o;if(_.isObject(s)&&s.ctype!=null)return Luca.util.lazyComponent(s);_.isObject(s)&&s.defines&&s["extends"]&&(n=s.defines,i=s["extends"]);if(_.isFunction(r=_(e).last()))return r()},_.extend(Luca,{VERSION:"0.9.65",core:{},containers:{},components:{},modules:{},util:{},fields:{},registry:{},options:{},config:{}}),_.extend(Luca,Backbone.Events),Luca.autoRegister=Luca.config.autoRegister=!0,Luca.developmentMode=Luca.config.developmentMode=!1,Luca.enableGlobalObserver=Luca.config.enableGlobalObserver=!1,Luca.enableBootstrap=Luca.config.enableBootstrap=!0,Luca.config.enhancedViewProperties=!0,Luca.keys={ENTER:13,ESCAPE:27,KEYLEFT:37,KEYUP:38,KEYRIGHT:39,KEYDOWN:40,SPACEBAR:32,FORWARDSLASH:191},Luca.keyMap=_(Luca.keys).inject(function(e,t,n){return e[t]=n.toLowerCase(),e},{}),Luca.find=function(e){return Luca($(e).data("luca-id"))},Luca.supportsEvents=Luca.supportsBackboneEvents=function(e){return Luca.isComponent(e)||_.isFunction(e!=null?e.trigger:void 0)||_.isFunction(e!=null?e.bind:void 0)},Luca.isComponent=function(e){return Luca.isBackboneModel(e)||Luca.isBackboneView(e)||Luca.isBackboneCollection(e)},Luca.isComponentPrototype=function(e){return Luca.isViewPrototype(e)||Luca.isModelPrototype(e)||Luca.isCollectionPrototype(e)},Luca.isBackboneModel=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),_.isFunction(e!=null?e.set:void 0)&&_.isFunction(e!=null?e.get:void 0)&&_.isObject(e!=null?e.attributes:void 0)},Luca.isBackboneView=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),_.isFunction(e!=null?e.render:void 0)&&!_.isUndefined(e!=null?e.el:void 0)},Luca.isBackboneCollection=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),_.isFunction(e!=null?e.fetch:void 0)&&_.isFunction(e!=null?e.reset:void 0)},Luca.isViewPrototype=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),e!=null&&e.prototype!=null&&e.prototype.make!=null&&e.prototype.$!=null&&e.prototype.render!=null},Luca.isModelPrototype=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),e!=null&&(typeof e.prototype=="function"?e.prototype(e.prototype.save!=null&&e.prototype.changedAttributes!=null):void 0)},Luca.isCollectionPrototype=function(e){return _.isString(e)&&(e=Luca.util.resolve(e)),e!=null&&e.prototype!=null&&!Luca.isModelPrototype(e)&&e.prototype.reset!=null&&e.prototype.select!=null&&e.prototype.reject!=null},Luca.inheritanceChain=function(e){return _(Luca.parentClasses(e)).map(function(e){return Luca.util.resolve(e)})},Luca.parentClasses=function(e){var t,n,r;return n=[],_.isString(e)&&(e=Luca.util.resolve(e)),n.push(e.displayName||((r=e.prototype)!=null?r.displayName:void 0)||Luca.parentClass(e)),t=function(){var t;t=[];while(Luca.parentClass(e)!=null)t.push(e=Luca.parentClass(e));return t}(),n=n.concat(t),_.uniq(n)},Luca.parentClass=function(e){var t,n,r;t=[],_.isString(e)&&(e=Luca.util.resolve(e));if(Luca.isComponent(e))return e.displayName;if(Luca.isComponentPrototype(e))return typeof (n=e.prototype)._superClass=="function"?(r=n._superClass())!=null?r.displayName:void 0:void 0},Luca.template=function(e,t){var n,r,i,s,o;window.JST||(window.JST={});if(_.isFunction(e))return e(t);r=(o=Luca.templates)!=null?o[e]:void 0,n=typeof JST!="undefined"&&JST!==null?JST[e]:void 0,r==null&&n==null&&(i=new RegExp(""+e+"$"),r=_(Luca.templates).detect(function(e,t){return i.exec(t)}),n=_(JST).detect(function(e,t){return i.exec(t)}));if(!r&&!n)throw"Could not find template named "+e;return s=r||n,t!=null?s(t):s},Luca.available_templates=function(e){var t;return e==null&&(e=""),t=_(Luca.templates).keys(),e.length>0?_(t).select(function(t){return t.match(e)}):t},e={module:function(e,t){_.extend(e,t);if(e.included&&_(e.included).isFunction())return e.included.apply(e)},"delete":function(e,t){var n;return n=e[t],delete e[t],n},idle:function(e,t){var n;return t==null&&(t=1e3),window.DISABLE_IDLE&&(t=0),n=void 0,function(){return n&&window.clearTimeout(n),n=window.setTimeout(_.bind(e,this),t)}},idleShort:function(e,t){var n;return t==null&&(t=100),window.DISABLE_IDLE&&(t=0),n=void 0,function(){return n&&window.clearTimeout(n),n=window.setTimeout(_.bind(e,this),t)}},idleMedium:function(e,t){var n;return t==null&&(t=2e3),window.DISABLE_IDLE&&(t=0),n=void 0,function(){return n&&window.clearTimeout(n),n=window.setTimeout(_.bind(e,this),t)}},idleLong:function(e,t){var n;return t==null&&(t=5e3),window.DISABLE_IDLE&&(t=0),n=void 0,function(){return n&&window.clearTimeout(n),n=window.setTimeout(_.bind(e,this),t)}}},_.mixin(e)}).call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/components/bootstrap_form_controls"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="btn-group form-actions">\n  <a class="btn btn-primary submit-button">\n    <i class="icon icon-ok icon-white"></i>\n    Save Changes\n  </a>\n  <a class="btn reset-button cancel-button">\n    <i class="icon icon-remove"></i>\n    Cancel\n  </a>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/components/collection_loader_view"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div id="progress-modal" class="modal" style="display: none">\n  <div class="progress progress-info progress-striped active">\n    <div class="bar" style="width:0%;"></div>\n  </div>\n  <div class="message">Initializing...</div>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/components/form_alert"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="',className,'">\n  <a class="close" href="#" data-dismiss="alert">x</a>\n  ',message,"\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/components/grid_view"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="luca-ui-g-view-wrapper">\n  <div class="g-view-header"></div>\n  <div class="luca-ui-g-view-body">\n    <table class="luca-ui-g-view scrollable-table" width="100%" cellpadding=0 cellspacing=0>\n      <thead class="fixed"></thead>\n      <tbody class="scrollable"></tbody>\n      <tfoot></tfoot>\n    </table>\n  </div>\n  <div class="luca-ui-g-view-header"></div>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/components/grid_view_empty_text"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="empty-text empty-text-wrapper">\n  <p>',text,"</p>\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/components/load_mask"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="load-mask">\n  <div class="progress progress-striped active">\n    <div class="bar" style="width:0%"></div>\n  </div>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/components/nav_bar"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="navbar-inner">\n  <div class="luca-ui-navbar-body container">\n  </div>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/components/pagination"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="pagination">\n  <a class="btn previous">\n    <i class="icon icon-chevron-left"></i>\n  </a>\n  <div class="pagination-group">\n  </div>\n  <a class="btn next">\n    <i class="icon icon-chevron-right"></i>\n  </a>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/containers/basic"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div id="',id,'" class="',classes,'" style="',style,'"></div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/containers/tab_selector_container"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{}){__p.push('<div id="',cid,'-tab-selector" class="tab-selector-container">\n  <ul id="',cid,'-tabs-nav" class="nav nav-tabs">\n    ');for(var i=0;i<components.length;i++){__p.push("\n    ");var component=components[i];__p.push('\n    <li class="tab-selector" data-target="',i,'">\n      <a data-target="',i,'">\n        ',component.title,"\n      </a>\n    </li>\n    ")}__p.push("\n  </ul>\n</div>\n")}return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/containers/tab_view"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<ul id="',cid,'-tabs-selector" class="nav ',navClass,'"></ul>\n<div id="',cid,'-tab-view-content" class="tab-content"></div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/containers/toolbar_wrapper"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="luca-ui-toolbar-wrapper" id="',id,'"></div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/button_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<label>&nbsp;</label>\n<input style="',inputStyles,'" class="btn ',input_class,'" value="',input_value,'" type="',input_type,'" id="<%= input_id" />\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/button_field_link"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<a class="btn ',input_class,'">\n  '),icon_class.length&&__p.push('\n  <i class="',icon_class,'"></i>\n  ',input_value,"\n  "),__p.push("\n</a>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/checkbox_array"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<div class="control-group">\n  <label for="',input_id,'"><%= label =>\n  <div class="controls"><div>\n</div>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/checkbox_array_item"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<label for="',input_id,'">\n  <input id="',input_id,'" type="checkbox" name="',input_name,'" value="',value,'" />\n</label>\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/checkbox_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<label for="',input_id,'">\n  ',label,'\n  <input type="checkbox" name="',input_name,'" value="',input_value,'" style="',inputStyles,'" />\n</label>\n\n'),helperText&&__p.push('\n<p class="helper-text help-block">\n  ',helperText,"\n</p>\n"),__p.push("\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/file_upload_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<label for="',input_id,'">\n  ',label,'\n  <input type="file" name="',input_name,'" value="',input_value,'" style="',inputStyles,'" />\n</label>\n\n'),helperText&&__p.push('\n<p class="helper-text help-block">\n  ',helperText,"\n</p>\n"),__p.push("\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/hidden_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(' <input type="hidden" name="',input_name,'" value="',input_value,'" style="',inputStyles,'" />\n');return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/select_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<label for="',input_id,'">\n  ',label,'\n</label>\n<div class="controls">\n <select name="',input_name,'" value="',input_value,'" style="',inputStyles,'" ></select>\n  '),helperText&&__p.push('\n  <p class="helper-text help-block">\n    ',helperText,"\n  </p>\n  "),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/text_area_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<label for="',input_id,'">\n  ',label,'\n</label>\n<div class="controls">\n <textarea name="',input_name,'" style="',inputStyles,'" placeholder="',placeHolder,'">',input_value,"</textarea>\n  "),helperText&&__p.push('\n  <p class="helper-text help-block">\n    ',helperText,"\n  </p>\n  "),__p.push("\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/fields/text_field"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push(""),(typeof label!="undefined"&&typeof hideLabel!="undefined"&&!hideLabel||typeof hideLabel=="undefined")&&__p.push('\n<label class="control-label" for="',input_id,'">',label,"</label>\n"),__p.push('\n\n<div class="controls">\n'),typeof addOn!="undefined"&&__p.push('\n  <span class="add-on">',addOn,"</span>\n"),__p.push('\n<input type="text" name="',input_name,'" style="',inputStyles,'" value="',input_value,'" placeholder="',placeHolder,'" />\n'),helperText&&__p.push('\n<p class="helper-text help-block">\n  ',helperText,"\n</p>\n"),__p.push("\n\n</div>\n");return __p.join("")}}.call(this),function(){this.JST||(this.JST={}),this.JST["luca-src/templates/table_view"]=function(obj){var __p=[],print=function(){__p.push.apply(__p,arguments)};with(obj||{})__p.push('<thead></thead>\n<tbody class="table-body"></tbody>\n<tfoot></tfoot>\n<caption></caption>\n');return __p.join("")}}.call(this),function(){var currentNamespace,__slice=Array.prototype.slice;Luca.util.resolve=function(e,t){var n;try{t||(t=window||global),n=_(e.split(/\./)).inject(function(e,t){return e=e!=null?e[t]:void 0},t)}catch(r){throw console.log("Error resolving",e,t),r}return n},Luca.util.nestedValue=Luca.util.resolve,Luca.util.argumentsLogger=function(e){return function(){return console.log(e,arguments)}},Luca.util.read=function(){var e,t;return t=arguments[0],e=2<=arguments.length?__slice.call(arguments,1):[],_.isFunction(t)?t.apply(this,e):t},Luca.util.classify=function(e){return e==null&&(e=""),_.string.camelize(_.string.capitalize(e))},Luca.util.hook=function(e){var t,n,r;return e==null&&(e=""),n=e.split(":"),r=n.shift(),n=_(n).map(function(e){return _.string.capitalize(e)}),t=r+n.join("")},Luca.util.isIE=function(){try{return Object.defineProperty({},"",{}),!1}catch(e){return!0}},currentNamespace=window||global,Luca.util.namespace=function(namespace){return namespace==null?currentNamespace:(currentNamespace=_.isString(namespace)?Luca.util.resolve(namespace,window||global):namespace,currentNamespace!=null?currentNamespace:currentNamespace=eval("(window||global)."+namespace+" = {}"))},Luca.util.lazyComponent=function(config){var componentClass,constructor,ctype;_.isObject(config)&&(ctype=config.ctype||config.type),_.isString(config)&&(ctype=config),componentClass=Luca.registry.lookup(ctype);if(!componentClass)throw"Invalid Component Type: "+ctype+".  Did you forget to register it?";return constructor=eval(componentClass),new constructor(config)},Luca.util.selectProperties=function(e,t,n){var r;return r=_(t).values(),_(r).select(e)},Luca.util.loadScript=function(e,t){var n;return n=document.createElement("script"),n.type="text/javascript",n.readyState&&(n.onreadystatechange=function(){return n.readyState==="loaded"||n.readyState==="complete"?(n.onreadystatechange=null,t()):n.onload=function(){return t()}}),n.src=e,document.body.appendChild(n)},Luca.util.make=Backbone.View.prototype.make,Luca.util.list=function(e,t,n){var r,i,s,o;t==null&&(t={}),r=n?"ol":"ul",r=Luca.util.make(r,t);if(_.isArray(e))for(s=0,o=e.length;s<o;s++)i=e[s],$(r).append(Luca.util.make("li",{},i));return r.outerHTML},Luca.util.label=function(e,t,n){var r;return e==null&&(e=""),n==null&&(n="label"),r=n,t!=null&&(r+=" "+n+"-"+t),Luca.util.make("span",{"class":r},e)},Luca.util.badge=function(e,t,n){var r;return e==null&&(e=""),n==null&&(n="badge"),r=n,t!=null&&(r+=" "+n+"-"+t),Luca.util.make("span",{"class":r},e)}}.call(this),function(){Luca.DevelopmentToolHelpers={refreshCode:function(){var e;return e=this,_(this.eventHandlerProperties()).each(function(t){return e[t]=e.definitionClass()[t]}),this.autoBindEventHandlers===!0&&this.bindAllEventHandlers(),this.delegateEvents()},eventHandlerProperties:function(){var e;return e=_(this.events).values(),_(e).select(function(e){return _.isString(e)})},eventHandlerFunctions:function(){var e,t=this;return e=_(this.events).values(),_(e).map(function(e){return _.isFunction(e)?e:t[e]})}}}.call(this),function(){var e,t=Array.prototype.slice;e=function(){function e(e,t,n){var r;this.object=e,n==null&&(n=!0),_.isFunction(t)?r=t:_.isString(t)&&_.isFunction(this.object[t])&&(r=this.object[t]);if(!_.isFunction(r))throw"Must pass a function or a string representing one";n===!0?this.fn=_.bind(function(){return _.defer(r)},this.object):this.fn=_.bind(r,this.object),this}return e.prototype.until=function(e,t){return e!=null&&t==null&&(t=e,e=this.object),e.once(t,this.fn),this.object},e}(),Luca.Events={defer:function(t,n){return n==null&&(n=!0),new e(this,t,n)},once:function(e,t,n){var r;return n||(n=this),r=function(){return t.apply(n,arguments),this.unbind(e,r)},this.bind(e,r)}},Luca.EventsExt={waitUntil:function(e,t){return this.waitFor.call(this,e,t)},waitFor:function(e,n){var r,i;return i=this,r={on:function(t){return t.waitFor.call(t,e,n)},and:function(){var r,s,o,u,a;s=1<=arguments.length?t.call(arguments,0):[],a=[];for(o=0,u=s.length;o<u;o++)r=s[o],r=_.isFunction(r)?r:i[r],a.push(i.once(e,r,n));return a},andThen:function(){return i.and.apply(i,arguments)}}},relayEvent:function(e){var n=this;return{on:function(){var r;return r=1<=arguments.length?t.call(arguments,0):[],{to:function(){var i,s,o,u,a,f;o=1<=arguments.length?t.call(arguments,0):[],f=[];for(u=0,a=o.length;u<a;u++)s=o[u],f.push(function(){var n,o,u,a=this;u=[];for(n=0,o=r.length;n<o;n++)i=r[n],u.push(i.on(e,function(){var n;return n=1<=arguments.length?t.call(arguments,0):[],n.unshift(e),s.trigger.apply(s,n)}));return u}.call(n));return f}}}}}}}.call(this),function(){var DefineProxy,__slice=Array.prototype.slice;_.mixin({def:Luca.component=Luca.define=Luca.register=function(e){return new DefineProxy(e)}}),DefineProxy=function(){function DefineProxy(e){var t;this.namespace=Luca.util.namespace(),this.componentId=this.componentName=e,this.superClassName="Luca.View",e.match(/\./)&&(this.namespaced=!0,t=e.split("."),this.componentId=t.pop(),this.namespace=t.join("."),Luca.registry.addNamespace(t.join(".")))}return DefineProxy.prototype["in"]=function(e){return this.namespace=e,this},DefineProxy.prototype.from=function(e){return this.superClassName=e,this},DefineProxy.prototype["extends"]=function(e){return this.superClassName=e,this},DefineProxy.prototype.extend=function(e){return this.superClassName=e,this},DefineProxy.prototype.triggers=function(){var e,t,n,r;t=1<=arguments.length?__slice.call(arguments,0):[],_.defaults(this.properties||(this.properties={}),{hooks:[]});for(n=0,r=t.length;n<r;n++)e=t[n],this.properties.hooks.push(e);return this.properties.hooks=_.uniq(this.properties.hooks),this},DefineProxy.prototype.includes=function(){var e,t,n,r;t=1<=arguments.length?__slice.call(arguments,0):[],_.defaults(this.properties||(this.properties={}),{include:[]});for(n=0,r=t.length;n<r;n++)e=t[n],this.properties.include.push(e);return this.properties.include=_.uniq(this.properties.include),this},DefineProxy.prototype.mixesIn=function(){var e,t,n,r;t=1<=arguments.length?__slice.call(arguments,0):[],_.defaults(this.properties||(this.properties={}),{mixins:[]});for(n=0,r=t.length;n<r;n++)e=t[n],this.properties.mixins.push(e);return this.properties.mixins=_.uniq(this.properties.mixins),this},DefineProxy.prototype.defaultProperties=function(properties){var at,componentType,_base;return properties==null&&(properties={}),_.defaults(this.properties||(this.properties={}),properties),at=this.namespaced?Luca.util.resolve(this.namespace,window||global):window||global,this.namespaced&&at==null&&(eval("(window||global)."+this.namespace+" = {}"),at=Luca.util.resolve(this.namespace,window||global)),at[this.componentId]=Luca.extend(this.superClassName,this.componentName,this.properties),Luca.autoRegister===!0&&(Luca.isViewPrototype(at[this.componentId])&&(componentType="view"),Luca.isCollectionPrototype(at[this.componentId])&&((_base=Luca.Collection).namespaces||(_base.namespaces=[]),Luca.Collection.namespaces.push(this.namespace),componentType="collection"),Luca.isModelPrototype(at[this.componentId])&&(componentType="model"),Luca.registerComponent(_.string.underscored(this.componentId),this.componentName,componentType)),at[this.componentId]},DefineProxy}(),DefineProxy.prototype.behavesAs=DefineProxy.prototype.uses=DefineProxy.prototype.mixesIn,DefineProxy.prototype.defines=DefineProxy.prototype.defaults=DefineProxy.prototype.exports=DefineProxy.prototype.defaultProperties,DefineProxy.prototype.defaultsTo=DefineProxy.prototype.enhance=DefineProxy.prototype["with"]=DefineProxy.prototype.defaultProperties,Luca.extend=function(e,t,n){var r,i,s,o,u,a;n==null&&(n={}),s=Luca.util.resolve(e,window||global),s.__initializers||(s.__initializers=[]);if(!_.isFunction(s!=null?s.extend:void 0))throw"Error defining "+t+". "+e+" is not a valid component to extend from";n.displayName=t,n._superClass=function(){return s.displayName||(s.displayName=e),s},n._super=function(e,t,n){var r;return t==null&&(t=this),n==null&&(n=[]),(r=this._superClass().prototype[e])!=null?r.apply(t,n):void 0},r=s.extend(n);if(_.isArray(n!=null?n.include:void 0)){a=n.include;for(o=0,u=a.length;o<u;o++)i=a[o],_.isString(i)&&(i=Luca.util.resolve(i)),_.extend(r.prototype,i)}return r},Luca.mixin=function(e){var t,n;return t=_(Luca.mixin.namespaces).detect(function(t){var n;return((n=Luca.util.resolve(t))!=null?n[e]:void 0)!=null}),t||(t="Luca.modules"),n=Luca.util.resolve(t)[e],n==null&&console.log("Could not find "+e+" in ",Luca.mixin.namespaces),n},Luca.mixin.namespaces=["Luca.modules"],Luca.mixin.namespace=function(e){return Luca.mixin.namespaces.push(e),Luca.mixin.namespaces=_(Luca.mixin.namespaces).uniq()},Luca.decorate=function(e){return _.isString(e)&&(e=Luca.util.resolve(e).prototype),{"with":function(t){var n,r,i,s,o;return n=Luca.mixin(t),r=_(n).chain().keys().select(function(e){return(""+e).match(/^__/)}),i=_(n).omit(r.value()),_.extend(e,i),n!=null&&(o=n.__included)!=null&&o.call(n,t),s=e._superClass().prototype.mixins,e.mixins||(e.mixins=[]),e.mixins.push(t),e.mixins=e.mixins.concat(s),e.mixins=_(e.mixins).chain().uniq().compact().value(),e}}}}.call(this),function(){Luca.modules.ApplicationEventBindings={__initializer:function(){var e,t,n,r,i,s,o;if(_.isEmpty(this.applicationEvents))return;e=this.app;if(_.isString(e)||_.isUndefined(e))e=(i=Luca.Application)!=null?typeof i.get=="function"?i.get(e):void 0:void 0;if(!Luca.supportsEvents(e))throw"Error binding to the application object on "+(this.name||this.cid);s=this.applicationEvents,o=[];for(n=0,r=s.length;n<r;n++){t=s[n],_.isString(n)&&(n=this[n]);if(!_.isFunction(n))throw"Error registering application event "+t+" on "+(this.name||this.cid);o.push(e.on(t,n))}return o}}}.call(this),function(){Luca.modules.CollectionEventBindings={__initializer:function(){var e,t,n,r,i,s,o,u,a;if(_.isEmpty(this.collectionEvents))return;i=this.collectionManager||Luca.CollectionManager.get(),o=this.collectionEvents,a=[];for(s in o){n=o[s],u=s.split(" "),r=u[0],t=u[1],e=i.getOrCreate(r);if(!e)throw"Could not find collection specified by "+r;_.isString(n)&&(n=this[n]);if(!_.isFunction(n))throw"invalid collectionEvents configuration";try{a.push(e.on(t,n,e))}catch(f){throw console.log("Error Binding To Collection in registerCollectionEvents",this),f}}return a}}}.call(this),function(){Luca.modules.Deferrable={configure_collection:function(e){var t,n,r;e==null&&(e=!0);if(!this.collection)return;_.isString(this.collection)&&(t=(n=Luca.CollectionManager)!=null?n.get():void 0)&&(this.collection=t.getOrCreate(this.collection)),this.collection&&_.isFunction(this.collection.fetch)&&_.isFunction(this.collection.reset)||(this.collection=new Luca.Collection(this.collection.initial_set,this.collection));if((r=this.collection)!=null?r.deferrable_trigger:void 0)this.deferrable_trigger=this.collection.deferrable_trigger;if(e)return this.deferrable=this.collection}}}.call(this),function(){Luca.modules.DomHelpers={__initializer:function(){var e,t,n,r,i;t=_(this.additionalClassNames||[]).clone(),this.wrapperClass!=null&&this.$wrap(this.wrapperClass),_.isString(t)&&(t=t.split(" ")),this.gridSpan&&t.push("span"+this.gridSpan),this.gridOffset&&t.push("offset"+this.gridOffset),this.gridRowFluid&&t.push("row-fluid"),this.gridRow&&t.push("row");if(t==null)return;i=[];for(n=0,r=t.length;n<r;n++)e=t[n],i.push(this.$el.addClass(e));return i},$wrap:function(e){return _.isString(e)&&!e.match(/[<>]/)&&(e=this.make("div",{"class":e})),this.$el.wrap(e)},$template:function(e,t){return t==null&&(t={}),this.$el.html(Luca.template(e,t))},$html:function(e){return this.$el.html(e)},$append:function(e){return this.$el.append(e)},$attach:function(){return this.$container().append(this.el)},$bodyEl:function(){return this.$el},$container:function(){return $(this.container)}}}.call(this),function(){Luca.modules.EnhancedProperties={__initializer:function(){if(Luca.config.enhancedViewProperties!==!0)return;_.isString(this.collection)&&Luca.CollectionManager.get()&&(this.collection=Luca.CollectionManager.get().getOrCreate(this.collection)),this.template!=null&&this.$template(this.template,this);if(_.isString(this.collectionManager))return this.collectionManager=Luca.CollectionManager.get(this.collectionManager)}}}.call(this),function(){var e,t=Object.prototype.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};Luca.modules.Filterable={__included:function(e,t){return _.extend(Luca.Collection.prototype,{__filters:{}})},__initializer:function(e,t){var n,r,i,s=this;if(this.filterable===!1)return;Luca.isBackboneCollection(this.collection)||(this.collection=typeof (r=Luca.CollectionManager).get=="function"?(i=r.get())!=null?i.getOrCreate(this.collection):void 0:void 0);if(!Luca.isBackboneCollection(this.collection)){this.debug("Skipping Filterable due to no collection being present on "+(this.name||this.cid)),this.debug("Collection",this.collection);return}return this.getCollection||(this.getCollection=function(){return this.collection}),n=this.getFilterState(),this.querySources||(this.querySources=[]),this.optionsSources||(this.optionsSources=[]),this.query||(this.query={}),this.queryOptions||(this.queryOptions={}),this.querySources.push(function(){return n.toQuery()}),this.optionsSources.push(function(){return n.toOptions()}),this.debugMode===!0&&(console.log("Filterable"),console.log(this.querySources),console.log(this.optionsSources)),n.on("change",function(){var e;return s.isRemote()?(e=_.extend(s.getQuery(),s.getQueryOptions()),s.collection.applyFilter(e,s.getQueryOptions())):s.trigger("refresh")}),t},isRemote:function(){return this.getQueryOptions().remote===!0},getFilterState:function(){var t,n;return(t=this.collection.__filters)[n=this.cid]||(t[n]=new e(this.filterable))},setSortBy:function(e,t){return t==null&&(t={}),this.getFilterState().setOption("sortBy",e,t)},applyFilter:function(e,t){return e==null&&(e={}),t==null&&(t={}),t=_.defaults(t,this.getQueryOptions()),e=_.defaults(e,this.getQuery()),this.getFilterState().set({query:e,options:t},t)}},e=function(e){function t(){t.__super__.constructor.apply(this,arguments)}return n(t,e),t.prototype.defaults={options:{},query:{}},t.prototype.setOption=function(e,t,n){var r;return r={},r[e]=t,this.set("options",_.extend(this.toOptions(),r),n)},t.prototype.setQueryOption=function(e,t,n){var r;return r={},r[e]=t,this.set("query",_.extend(this.toQuery(),r),n)},t.prototype.toOptions=function(){return this.toJSON().options},t.prototype.toQuery=function(){return this.toJSON().query},t.prototype.toRemote=function(){var e;return e=this.toOptions(),_.extend(this.toQuery(),{limit:e.limit,page:e.page,sortBy:e.sortBy})},t}(Backbone.Model)}.call(this),function(){Luca.modules.GridLayout={_initializer:function(){this.gridSpan&&this.$el.addClass("span"+this.gridSpan),this.gridOffset&&this.$el.addClass("offset"+this.gridOffset),this.gridRowFluid&&this.$el.addClass("row-fluid");if(this.gridRow)return this.$el.addClass("row")}}}.call(this),function(){Luca.modules.LoadMaskable={__initializer:function(){var e=this;if(this.loadMask!==!0)return;if(this.loadMask===!0)return this.defer(function(){e.$el.addClass("with-mask");if(e.$(".load-mask").length===0)return e.loadMaskTarget().prepend(Luca.template(e.loadMaskTemplate,e)),e.$(".load-mask").hide()}).until("after:render"),this.on(this.loadmaskEnableEvent||"enable:loadmask",this.applyLoadMask,this),this.on(this.loadmaskDisableEvent||"disable:loadmask",this.applyLoadMask,this)},showLoadMask:function(){return this.trigger("enable:loadmask")},hideLoadMask:function(){return this.trigger("disable:loadmask")},loadMaskTarget:function(){return this.loadMaskEl!=null?this.$(this.loadMaskEl):this.$bodyEl()},disableLoadMask:function(){return this.$(".load-mask .bar").css("width","100%"),this.$(".load-mask").hide(),clearInterval(this.loadMaskInterval)},enableLoadMask:function(){var e,t=this;this.$(".load-mask").show().find(".bar").css("width","0%"),e=this.$(".load-mask .progress").width(),e<20&&(e=this.$el.width())<20&&(e=this.$el.parent().width()),this.loadMaskInterval=setInterval(function(){var e,n;return e=t.$(".load-mask .bar").width(),n=e+12,t.$(".load-mask .bar").css("width",n)},200);if(this.loadMaskTimeout==null)return;return _.delay(function(){return t.disableLoadMask()},this.loadMaskTimeout)},applyLoadMask:function(){return this.$(".load-mask").is(":visible")?this.disableLoadMask():this.enableLoadMask()}}}.call(this),function(){Luca.LocalStore=function(){function e(e){var t;this.name=e,t=localStorage.getItem(this.name),this.data=t&&JSON.parse(t)||{}}return e.prototype.guid=function(){var e;return e=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},e.prototype.save=function(){return localStorage.setItem(this.name,JSON.stringify(this.data))},e.prototype.create=function(e){return e.id||(e.id=e.attribtues.id=this.guid()),this.data[e.id]=e,this.save(),e},e.prototype.update=function(e){return this.data[e.id]=e,this.save(),e},e.prototype.find=function(e){return this.data[e.id]},e.prototype.findAll=function(){return _.values(this.data)},e.prototype.destroy=function(e){return delete this.data[e.id],this.save(),e},e}(),Backbone.LocalSync=function(e,t,n){var r,i;return i=t.localStorage||t.collection.localStorage,r=function(){switch(e){case"read":return t.id?i.find(t):i.findAll();case"create":return i.create(t);case"update":return i.update(t);case"delete":return i.destroy(t)}}(),r?n.success(r):n.error("Record not found")}}.call(this),function(){var e;Luca.modules.ModalView={closeOnEscape:!0,showOnInitialize:!1,backdrop:!1,__initializer:function(){return this.$el.addClass("modal"),this.on("before:render",e,this),this},container:function(){return $("body")},toggle:function(){return this.$el.modal("toggle")},show:function(){return this.$el.modal("show")},hide:function(){return this.$el.modal("hide")}},e=function(){return this.$el.addClass("modal"),this.fade===!0&&this.$el.addClass("fade"),$("body").append(this.$el),this.$el.modal({backdrop:this.backdrop===!0,keyboard:this.closeOnEscape===!0,show:this.showOnInitialize===!0}),this}}.call(this),function(){Luca.modules.Paginatable={paginatorViewClass:"Luca.components.PaginationControl",paginationSelector:".toolbar.bottom",__included:function(){return _.extend(Luca.Collection
.prototype,{__paginators:{}})},__initializer:function(){var e,t,n,r,i=this;if(this.paginatable===!1)return;Luca.isBackboneCollection(this.collection)||(this.collection=typeof (n=Luca.CollectionManager).get=="function"?(r=n.get())!=null?r.getOrCreate(this.collection):void 0:void 0);if(!Luca.isBackboneCollection(this.collection)){this.debug("Skipping Paginatable due to no collection being present on "+(this.name||this.cid)),this.debug("collection",this.collection);return}return _.bindAll(this,"paginationControl","pager"),this.getCollection||(this.getCollection=function(){return this.collection}),e=this.getCollection(),t=this.getPaginationState(),this.optionsSources||(this.optionsSources=[]),this.queryOptions||(this.queryOptions={}),this.optionsSources.push(function(){var e;return e=_(t.toJSON()).pick("limit","page","sortBy"),_.extend(e,{pager:i.pager})}),t.on("change:page",function(e){var t;return i.isRemote()?(t=_.extend(i.toQuery(),i.toQueryOptions()),i.collection.applyFilter(t,{remote:!0})):i.trigger("refresh")}),this.on("before:render",this.renderPaginationControl,this)},pager:function(e,t){return this.getPaginationState().set({numberOfPages:e,itemCount:t.length}),this.paginationControl().updateWithPageCount(e,t)},isRemote:function(){return this.getQueryOptions().remote===!0},getPaginationState:function(){var e,t;return(e=this.collection.__paginators)[t=this.cid]||(e[t]=this.paginationControl().state)},paginationContainer:function(){return this.$(">"+this.paginationSelector)},setCurrentPage:function(e,t){return e==null&&(e=1),t==null&&(t={}),this.getPaginationState().set("page",e,t)},setPage:function(e,t){return e==null&&(e=1),t==null&&(t={}),this.getPaginationState().set("page",e,t)},setLimit:function(e,t){return e==null&&(e=0),t==null&&(t={}),this.getPaginationState().set("limit",e,t)},paginationControl:function(){return this.paginator!=null?this.paginator:(_.defaults(this.paginatable||(this.paginatable={}),{page:1,limit:20}),this.paginator=Luca.util.lazyComponent({type:"pagination_control",collection:this.getCollection(),defaultState:this.paginatable,parent:this.name||this.cid,debugMode:this.debugMode}),this.paginator)},renderPaginationControl:function(){var e;return e=this.paginationControl(),this.paginationContainer().append(e.render().$el),e}}}.call(this),function(){Luca.modules.StateModel={__initializer:function(){var e=this;if(this.stateful!==!0)return;if(this.state!=null&&!Luca.isBackboneModel(this.state))return;return this.state=new Backbone.Model(this.defaultState||{}),this.set||(this.set=function(){return e.state.set.apply(e.state,arguments)}),this.get||(this.get=function(){return e.state.get.apply(e.state,arguments)}),this.state.on("change",function(t){var n,r,i,s,o,u;e.trigger("state:change",t),r=t.previousAttributes(),o=t.changedAttributes,u=[];for(i=0,s=o.length;i<s;i++)n=o[i],u.push(e.trigger("state:change:"+n,i,t.previous(n)));return u})}}}.call(this),function(){Luca.modules.Templating={__initializer:function(){var e,t,n;n=Luca.util.read.call(this,this.bodyTemplateVars)||{};if(e=this.bodyTemplate)return this.$el.empty(),t=Luca.template(e,n),Luca.View.prototype.$html.call(this,t)}}}.call(this),function(){var e,t;t={classes:{},model_classes:{},collection_classes:{},namespaces:["Luca.containers","Luca.components"]},e={cid_index:{},name_index:{}},Luca.config.defaultComponentClass=Luca.defaultComponentClass="Luca.View",Luca.config.defaultComponentType=Luca.defaultComponentType="view",Luca.registry.aliases={grid:"grid_view",form:"form_view",text:"text_field",button:"button_field",select:"select_field",card:"card_view",paged:"card_view",wizard:"card_view",collection:"collection_view",list:"collection_view",multi:"collection_multi_view",table:"table_view"},Luca.registerComponent=function(e,n,r){r==null&&(r="view"),Luca.trigger("component:registered",e,n);switch(r){case"model":return t.model_classes[e]=n;case"collection":return t.collection_classes[e]=n;default:return t.classes[e]=n}},Luca.development_mode_register=function(e,n){var r,i,s;return r=t.classes[e],Luca.enableDevelopmentTools===!0&&r!=null&&(s=Luca.util.resolve(r,window),i=Luca.registry.findInstancesByClassName(n),_(i).each(function(e){var t;return e!=null?(t=e.refreshCode)!=null?t.call(e,s):void 0:void 0})),Luca.registerComponent(e,n)},Luca.registry.addNamespace=Luca.registry.namespace=function(e){return t.namespaces.push(e),t.namespaces=_(t.namespaces).uniq()},Luca.registry.namespaces=function(e){return e==null&&(e=!0),_(t.namespaces).map(function(t){return e?Luca.util.resolve(t):t})},Luca.registry.lookup=function(e){var n,r,i,s,o,u;if(n=Luca.registry.aliases[e])e=n;return r=t.classes[e],r!=null?r:(i=Luca.util.classify(e),o=Luca.registry.namespaces(),s=(u=_(o).chain().map(function(e){return e[i]}).compact().value())!=null?u[0]:void 0)},Luca.registry.instances=function(){return _(e.cid_index).values()},Luca.registry.findInstancesByClass=function(e){return Luca.registry.findInstancesByClassName(e.displayName)},Luca.registry.findInstancesByClassName=function(e){var t;return _.isString(e)||(e=e.displayName),t=Luca.registry.instances(),_(t).select(function(t){var n,r;return n=t.displayName===e,t.displayName===e||(typeof t._superClass=="function"?(r=t._superClass())!=null?r.displayName:void 0:void 0)===e})},Luca.registry.classes=function(e){return e==null&&(e=!1),_(_.extend({},t.classes,t.model_classes,t.collection_classes)).map(function(t,n){return e?t:{className:t,ctype:n}})},Luca.cache=Luca.cacheInstance=function(t,n){var r;if(t==null)return;return(n!=null?n.doNotCache:void 0)===!0?n:(n!=null&&(e.cid_index[t]=n),n=e.cid_index[t],(n!=null?n.component_name:void 0)!=null?e.name_index[n.component_name]=n.cid:(n!=null?n.name:void 0)!=null&&(e.name_index[n.name]=n.cid),n!=null?n:(r=e.name_index[t],e.cid_index[r]))}}.call(this),function(){var e=Array.prototype.slice;Luca.Observer=function(){function t(e){var t=this;this.options=e!=null?e:{},_.extend(this,Backbone.Events),this.type=this.options.type,this.options.debugAll&&this.bind("all",function(e,t,n){return console.log("ALL",e,t,n)})}return t.prototype.relay=function(){var t,n;return n=arguments[0],t=2<=arguments.length?e.call(arguments,1):[],console.log("Relaying",trigger,t),this.trigger("event",n,t),this.trigger("event:"+t[0],n,t.slice(1))},t}(),Luca.Observer.enableObservers=function(e){return e==null&&(e={}),Luca.enableGlobalObserver=!0,Luca.ViewObserver=new Luca.Observer(_.extend(e,{type:"view"})),Luca.CollectionObserver=new Luca.Observer(_.extend(e,{type:"collection"}))}}.call(this),function(){var e,t,n,r=Array.prototype.slice;n=Luca.register("Luca.View"),n["extends"]("Backbone.View"),n.includes("Luca.Events","Luca.modules.DomHelpers"),n.mixesIn("DomHelpers","Templating","EnhancedProperties","CollectionEventBindings","ApplicationEventBindings","StateModel"),n.triggers("before:initialize","after:initialize","before:render","after:render","first:activation","activation","deactivation"),n.defines({initialize:function(t){return this.options=t!=null?t:{},this.trigger("before:initialize",this,this.options),_.extend(this,this.options),(this.autoBindEventHandlers===!0||this.bindAllEvents===!0)&&e.call(this),this.name!=null&&(this.cid=_.uniqueId(this.name)),this.$el.attr("data-luca-id",this.name||this.cid),Luca.cacheInstance(this.cid,this),this.setupHooks(_(Luca.View.prototype.hooks.concat(this.hooks)).uniq()),this.setupMixins(),this.delegateEvents(),this.trigger("after:initialize",this)},setupMixins:function(){var e,t,n,r,i,s,o,u;if(((r=this.mixins)!=null?r.length:void 0)>0){i=this.mixins,u=[];for(t=0,n=i.length;t<n;t++)e=i[t],u.push((s=Luca.mixin(e))!=null?(o=s.__initializer)!=null?o.call(this,this,e):void 0:void 0);return u}},setupHooks:function(e){var t=this;return e||(e=this.hooks),_(e).each(function(e){var n,r;r=Luca.util.hook(e),n=function(){var e;return(e=this[r])!=null?e.apply(this,arguments):void 0};if(e!=null?e.match(/once:/):void 0)n=_.once(n);return t.on(e,n,t)})},registerEvent:function(e,t){return this.events||(this.events={}),this.events[e]=t,this.delegateEvents()},definitionClass:function(){var e;return(e=Luca.util.resolve(this.displayName,window))!=null?e.prototype:void 0},collections:function(){return Luca.util.selectProperties(Luca.isBackboneCollection,this)},models:function(){return Luca.util.selectProperties(Luca.isBackboneModel,this)},views:function(){return Luca.util.selectProperties(Luca.isBackboneView,this)},debug:function(){var e;e=1<=arguments.length?r.call(arguments,0):[];if(!this.debugMode&&window.LucaDebugMode==null)return;return console.log([this.name||this.cid].concat(r.call(e)))},trigger:function(){return Luca.enableGlobalObserver&&(Luca.developmentMode===!0||this.observeEvents===!0)&&(Luca.ViewObserver||(Luca.ViewObserver=new Luca.Observer({type:"view"})),Luca.ViewObserver.relay(this,arguments)),Backbone.View.prototype.trigger.apply(this,arguments)}}),Luca.View._originalExtend=Backbone.View.extend,Luca.View.renderWrapper=function(e){var t;return t=e.render,t||(t=Luca.View.prototype.$attach),e.render=function(){var e,r,i,s,o,u=this;return n=this,this.deferrable?(s=this.deferrable_target,Luca.isBackboneCollection(this.deferrable)||(this.deferrable=this.collection),s||(s=this.deferrable),o=this.deferrable_event?this.deferrable_event:Luca.View.deferrableEvent,r=function(){return t.call(n),n.trigger("after:render",n)},n.defer(r).until(s,o),n.trigger("before:render",this),e=this.deferrable_trigger||this.deferUntil,e==null?s[this.deferrable_method||"fetch"].call(s):(i=_.once(function(){var e,t;return typeof (e=u.deferrable)[t=u.deferrable_method||"fetch"]=="function"?e[t]():void 0}),(this.deferrable_target||this).bind(this.deferrable_trigger,i)),this):(this.trigger("before:render",this),t.apply(this,arguments),this.trigger("after:render",this),this)},e},e=function(){var e,n,r,i,s;i=[this.events,this.componentEvents,this.collectionEvents,this.applicationEvents],s=[];for(n=0,r=i.length;n<r;n++)e=i[n],_.isEmpty(e)||s.push(t.call(this,e));return s},t=function(e){var t,n,r;e==null&&(e={}),r=[];for(t in e)n=e[t],_.isString(n)?r.push(_.bindAll(this,n)):r.push(void 0);return r},Luca.View.extend=function(e){var t,n,r,i;e=Luca.View.renderWrapper(e);if(e.mixins!=null&&_.isArray(e.mixins)){i=e.mixins;for(n=0,r=i.length;n<r;n++)t=i[n],Luca.decorate(e)["with"](t)}return Luca.View._originalExtend.call(this,e)},Luca.View.deferrableEvent="reset"}.call(this),function(){var e,t;e=Luca.define("Luca.Model"),e["extends"]("Backbone.Model"),e.includes("Luca.Events"),e.defines({initialize:function(){return Backbone.Model.prototype.initialize(this,arguments),t.call(this)},read:function(e){return _.isFunction(this[e])?this[e].call(this):this.get(e)},get:function(e){var t;return((t=this.computed)!=null?t.hasOwnProperty(e):void 0)?this._computed[e]:Backbone.Model.prototype.get.call(this,e)}}),t=function(){var e,t,n,r,i=this;if(_.isUndefined(this.computed))return;this._computed={},n=this.computed,r=[];for(e in n)t=n[e],this.on("change:"+e,function(){return i._computed[e]=i[e].call(i)}),_.isString(t)&&(t=t.split(",")),r.push(_(t).each(function(t){i.on("change:"+t,function(){return i.trigger("change:"+e)});if(i.has(t))return i.trigger("change:"+e)}));return r}}.call(this),function(){var e;e=Luca.define("Luca.Collection"),Backbone.QueryCollection!=null?e["extends"]("Backbone.QueryCollection"):e["extends"]("Backbone.Collection"),e.includes("Luca.Events"),e.defines({model:Luca.Model,cachedMethods:[],remoteFilter:!1,initialize:function(e,t){var n,r=this;e==null&&(e=[]),this.options=t,_.extend(this,this.options),this.setupMethodCaching(),this._reset(),this.cached&&console.log("The @cached property of Luca.Collection is being deprecated.  Please change to cache_key");if(this.cache_key||(this.cache_key=this.cached))this.bootstrap_cache_key=_.isFunction(this.cache_key)?this.cache_key():this.cache_key;(this.registerAs||this.registerWith)&&console.log("This configuration API is deprecated.  use @name and @manager properties instead"),this.name||(this.name=this.registerAs),this.manager||(this.manager=this.registerWith),this.manager=_.isFunction(this.manager)?this.manager():this.manager,this.name&&!this.manager&&(this.manager=Luca.CollectionManager.get()),this.manager&&(this.name||(this.name=this.cache_key()),this.name=_.isFunction(this.name)?this.name():this.name,!this.private&&!this.anonymous&&this.bind("after:initialize",function(){return r.register(r.manager,r.name,r)}));if(this.useLocalStorage===!0&&window.localStorage!=null)throw n=this.bootstrap_cache_key||this.name,"Must specify either a cached or registerAs property to use localStorage";return _.isArray(this.data)&&this.data.length>0&&(this.memoryCollection=!0),this.useNormalUrl!==!0&&this.__wrapUrl(),Backbone.Collection.prototype.initialize.apply(this,[e,this.options]),e&&this.reset(e,{silent:!0,parse:t!=null?t.parse:void 0}),this.trigger("after:initialize")},__wrapUrl:function(){var e,t,n=this;return _.isFunction(this.url)?this.url=_.wrap(this.url,function(e){var t,r,i,s,o;return o=e.apply(n),i=o.split("?"),i.length>1&&(t=_.last(i)),s=n.queryString(),t&&o.match(t)&&(s=s.replace(t,"")),r=""+o+"?"+s,r.match(/\?$/)&&(r=r.replace(/\?$/,"")),r}):(t=this.url,e=this.queryString(),this.url=_([t,e]).compact().join("?"))},queryString:function(){var e,t=this;return e=_(this.base_params||(this.base_params=Luca.Collection.baseParams())).inject(function(e,t,n){var r;return r=""+n+"="+t,e.push(r),e},[]),_.uniq(e).join("&")},resetFilter:function(){return this.base_params=_(Luca.Collection.baseParams()).clone(),this},applyFilter:function(e,t){return e==null&&(e={}),t==null&&(t={}),t.remote!=null==1||this.remoteFilter===!0?(this.applyParams(e),this.fetch(_.extend(t,{refresh:!0}))):this.reset(this.query(e))},applyParams:function(e){return this.base_params=_(Luca.Collection.baseParams()).clone(),_.extend(this.base_params,e),this},register:function(e,t,n){e==null&&(e=Luca.CollectionManager.get()),t==null&&(t="");if(!(t.length>=1))throw"Can not register with a collection manager without a key";if(e==null)throw"Can not register with a collection manager without a valid collection manager";_.isString(e)&&(e=Luca.util.nestedValue(e,window||global));if(!e)throw"Could not register with collection manager";if(_.isFunction(e.add))return e.add(t,n);if(_.isObject(e))return e[t]=n},loadFromBootstrap:function(){if(!this.bootstrap_cache_key)return;return this.reset(this.cached_models()),this.trigger("bootstrapped",this)},bootstrap:function(){return this.loadFromBootstrap()},cached_models:function(){return Luca.Collection.cache(this.bootstrap_cache_key)},fetch:function(e){var t;e==null&&(e={}),this.trigger("before:fetch",this);if(this.memoryCollection===!0)return this.reset(this.data);if(this.cached_models().length&&!e.refresh)return this.bootstrap();t=_.isFunction(this.url)?this.url():this.url;if(!(t&&t.length>1||this.localStorage))return!0;this.fetching=!0;try{return Backbone.Collection.prototype.fetch.apply(this,arguments)}catch(n){throw console.log("Error in Collection.fetch",n),n}},onceLoaded:function(e,t){var n,r=this;t==null&&(t={autoFetch:!0});if(this.length>0&&!this.fetching){e.apply(this,[this]);return}n=function(){return e.apply(r,[r])},this.bind("reset",function(){return n(),this.unbind("reset",this)});if(!this.fetching&&!!t.autoFetch)return this.fetch()},ifLoaded:function(e,t){var n,r=this;t==null&&(t={scope:this,autoFetch:!0}),n=t.scope||this,this.length>0&&!this.fetching&&e.apply(n,[this]),this.bind("reset",function(t){return e.call(n,t)});if(!(this.fetching===!0||!t.autoFetch||this.length>0))return this.fetch()},parse:function(e){var t;return this.fetching=!1,this.trigger("after:response",e),t=this.root!=null?e[this.root]:e,this.bootstrap_cache_key&&Luca.Collection.cache(this.bootstrap_cache_key,t),t},restoreMethodCache:function(){var e,t,n,r;n=this._methodCache,r=[];for(t in n)e=n[t],e.original!=null?(e.args=void 0,r.push(this[t]=e.original)):r.push(void 0);return r},clearMethodCache:function(e){return this._methodCache[e].value=void 0},clearAllMethodsCache:function(){var e,t,n,r;n=this._methodCache,r=[];for(t in n)e=n[t],r.push(this.clearMethodCache(t));return r},setupMethodCaching:function(){var t,n;return e=this,n=["reset","add","remove"],t=this._methodCache={},_(this.cachedMethods).each(function(r){var i,s,o,u,a,f,l,c,h;t[r]={name:r,original:e[r],value:void 0},e[r]=function(){var n;return(n=t[r]).value||(n.value=t[r].original.apply(e,arguments))};for(u=0,f=n.length;u<f;u++)o=n[u],e.bind(o,function(){return e.clearAllMethodsCache()});i=r.split(":")[1];if(i){c=i.split(","),h=[];for(a=0,l=c.length;a<l;a++)s=c[a],h.push(e.bind("change:"+s,function(){return e.clearMethodCache({method:r})}));return h}})},query:function(e,t){return e==null&&(e={}),t==null&&(t={}),Backbone.QueryCollection!=null?Backbone.QueryCollection.prototype.query.apply(this,arguments):this.models}}),_.extend(Luca.Collection.prototype,{trigger:function(){return Luca.enableGlobalObserver&&(Luca.CollectionObserver||(Luca.CollectionObserver=new Luca.Observer({type:"collection"})),Luca.CollectionObserver.relay(this,arguments)),Backbone.View.prototype.trigger.apply(this,arguments)}}),Luca.Collection.baseParams=function(e){if(e)return Luca.Collection._baseParams=e;if(_.isFunction(Luca.Collection._baseParams))return Luca.Collection._baseParams();if(_.isObject(Luca.Collection._baseParams))return Luca.Collection._baseParams},Luca.Collection._bootstrapped_models={},Luca.Collection.bootstrap=function(e){return _.extend(Luca.Collection._bootstrapped_models,e)},Luca.Collection.cache=function(e,t){return t?Luca.Collection._bootstrapped_models[e]=t:Luca.Collection._bootstrapped_models[e]||[]}}.call(this),function(){var e;e=function(e,t){var n,r,i,s,o;return e==null&&(e={}),e.orientation||(e.orientation="top"),e.ctype||(e.ctype=this.toolbarType||"panel_toolbar"),s=""+this.cid+"-tbc-"+e.orientation,o=Luca.util.lazyComponent(e),r=this.make("div",{"class":"toolbar-container "+e.orientation,id:s},o.render().el),i=this.bodyClassName||this.bodyTagName,n=function(){switch(e.orientation){case"top":case"left":return i?"before":"prepend";case"bottom":case"right":return i?"after":"append"}}(),(t||this.$bodyEl())[n](r)},_.def("Luca.components.Panel")["extends"]("Luca.View")["with"]({topToolbar:void 0,bottomToolbar:void 0,loadMask:!1,loadMaskTemplate:["components/load_mask"],loadMaskTimeout:3e3,mixins:["LoadMaskable"],initialize:function(e){return this.options=e!=null?e:{},Luca.View.prototype.initialize.apply(this,arguments)},applyStyles:function(e,t){var n,r,i;e==null&&(e={}),t==null&&(t=!1),r=t?this.$bodyEl():this.$el;for(n in e)i=e[n],r.css(n,i);return this},beforeRender:function(){var e;return(e=Luca.View.prototype.beforeRender)!=null&&e.apply(this,arguments),this.styles!=null&&this.applyStyles(this.styles),this.bodyStyles!=null&&this.applyStyles(this.bodyStyles,!0),typeof this.renderToolbars=="function"?this.renderToolbars():void 0},$bodyEl:function(){var e,t,n,r;return n=this.bodyTagName||"div",t=this.bodyClassName||"view-body",this.bodyEl||(this.bodyEl=""+n+"."+t),e=this.$(this.bodyEl),e.length>0?e:e.length!==0||this.bodyClassName==null&&this.bodyTagName==null?$(this.el):(r=this.make(n,{"class":t,"data-auto-appended":!0}),$(this.el).append(r),this.$(this.bodyEl))},$wrap:function(e){return _.isString(e)&&!e.match(/[<>]/)&&(e=this.make("div",{"class":e})),this.$el.wrap(e)},$template:function(e,t){return t==null&&(t={}),this.$html(Luca.template(e,t))},$empty:function(){return this.$bodyEl().empty()},$html:function(e){return this.$bodyEl().html(e)},$append:function(e){return this.$bodyEl().append(e)},renderToolbars:function(){var e=this;return _(["top","left","right","bottom"]).each(function(t){var n;if(n=e[""+t+"Toolbar"])return e.renderToolbar(t,n)})},renderToolbar:function(t,n){return t==null&&(t="top"),n==null&&(n={}),n.parent=this,n.orientation=t,e.call(this,n,n.targetEl)}})}.call(this),function(){_.def("Luca.core.Field")["extends"]("Luca.View")["with"]({className:"luca-ui-text-field luca-ui-field",isField:!0,template:"fields/text_field",labelAlign:"top",hooks:["before:validation","after:validation","on:change"],statuses:["warning","error","success"],initialize:function(e){var t;return this.options=e!=null?e:{},_.extend(this,this.options),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.input_class||(this.input_class=""),this.input_type||(this.input_type=""),this.helperText||(this.helperText=""),this.required&&((t=this.label)!=null?!t.match(/^\*/):!void 0)&&(this.label||(this.label="*"+this.label)),this.inputStyles||(this.inputStyles=""),this.input_value||(this.input_value=this.value||""),this.disabled&&this.disable(),this.updateState(this.state),this.placeHolder||(this.placeHolder=""),Luca.View.prototype.initialize.apply(this,arguments)},beforeRender:function(){Luca.enableBootstrap&&this.$el.addClass("control-group");if(this.required)return this.$el.addClass("required")},change_handler:function(e){return this.trigger("on:change",this,e)},disable:function(){return this.getInputElement().attr("disabled",!0)},enable:function(){return this.getInputElement().attr("disabled",!1)},getValue:function(){var e,t;e=(t=this.getInputElement())!=null?t.attr("value"):void 0;if(_.str.isBlank(e))return e;switch(this.valueType){case"integer":return parseInt(e);case"string":return""+e;case"float":return parseFloat(e);default:return e}},setValue:function(e){var t;return(t=this.getInputElement())!=null?t.attr("value",e):void 0},getInputElement:function(){return this.input||(this.input=this.$("input").eq(0))},updateState:function(e){var t=this;return _(this.statuses).each(function(n){return t.$el.removeClass(n),t.$el.addClass(e)})}})}.call(this),function(){var e,t,n,r,i,s,o,u;t=Luca.register("Luca.core.Container"),t["extends"]("Luca.components.Panel"),t.triggers("before:components","before:render:components","before:layout","after:components","after:layout","first:activation"),t.defines({className:"luca-ui-container",componentTag:"div",componentClass:"luca-ui-panel",isContainer:!0,rendered:!1,components:[],componentEvents:{},initialize:function(e){return this.options=e!=null?e:{},_.extend(this,this.options),this.setupHooks(Luca.core.Container.prototype.hooks),this.components||(this.components=this.fields||(this.fields=this.pages||(this.pages=this.cards||(this.cards=this.views)))),u(this),Luca.View.prototype.initialize.apply(this,arguments)},beforeRender:function(){var e;return s.call(this),i.call(this),(e=Luca.components.Panel.prototype.beforeRender)!=null?e.apply(this,arguments):void 0},customizeContainerEl:function(e,t,n){return e},prepareLayout:function(){return t=this,this.componentContainers=_(this.components).map(function(n,r){return e.call(t,n,r)})},prepareComponents:function(){var e,t,n,r,i=this;r=this.components;for(t=0,n=r.length;t<n;t++)e=r[t],_.isString(e)&&(e={type:e});return _(this.components).each(function(e,t){var n,r,s,o;n=r=(o=i.componentContainers)!=null?o[t]:void 0,n["class"]=n["class"]||n.className||n.classes,i.generateComponentElements&&(s=i.make(i.componentTag,r,""),i.$append(s));if(e.container==null)return i.generateComponentElements&&(e.container="#"+r.id),e.container||(e.container=i.$bodyEl())})},createComponents:function(){var e,n=this;if(this.componentsCreated===!0)return;return e=this.componentIndex={name_index:{},cid_index:{},role_index:{}},t=this,this.components=_(this.components).map(function(e,r){var i,s,u;return i=Luca.isComponent(e)?e:(e.type||(e.type=e.ctype),e.type==null?e.components!=null?e.type=e.ctype="container":e.type=e.ctype=Luca.defaultComponentType:void 0,e=_.defaults(e,t.defaults||{}),s=Luca.util.lazyComponent(e)),!i.container&&((u=i.options)!=null?u.container:void 0)&&(i.container=i.options.container),i.container==null&&(console.log(i,r,n),console.error("could not assign container property to component on container "+(n.name||n.cid))),o(i).at(r)["in"](n.componentIndex),i}),this.componentsCreated=!0,e},renderComponents:function(e){return this.debugMode=e!=null?e:"",this.debug("container render components"),t=this,_(this.components).each(function(e){e.getParent=function(){return t};try{return this.$(e.container).eq(0).append(e.el),e.render()}catch(n){console.log("Error Rendering Component "+(e.name||e.cid),e),_.isObject(n)&&(console.log(n.message),console.log(n.stack));if(Luca.silenceRenderErrors!=null!=1)throw n}})},firstActivation:function(){var e;return e=this,this.each(function(t,n){var r;if((t!=null?t.previously_activated:void 0)!==!0)return t!=null&&(r=t.trigger)!=null&&r.call(t,"first:activation",t,e),t.previously_activated=!0})},_:function(){return _(this.components)},pluck:function(e){return this._().pluck(e)},invoke:function(e){return this._().invoke(e)},select:function(e){return this._().select(e)},detect:function(e){return this._().detect(attribute)},reject:function(e){return this._().reject(e)},map:function(e){return this._().map(e)},registerComponentEvents:function(e){var n,r,i,s,o,u,a,f,l=this;t=this,u=e||this.componentEvents||{},f=[];for(o in u){s=u[o],a=o.split(" "),r=a[0],i=a[1];if(!_.isFunction(this[s]))throw console.log("Error registering component event",o,r,i),"Invalid component event definition "+o+". Specified handler is not a method on the container";if(r==="*")f.push(this.eachComponent(function(e){return e.on(i,l[s],t)}));else{n=this.findComponentForEventBinding(r);if(n==null||!Luca.isComponent(n))throw console.log("Error registering component event",o,r,i),"Invalid component event definition: "+r;f.push(n!=null?n.bind(i,this[s],t):void 0)}}return f},subContainers:function(){return this.select(function(e){return e.isContainer===!0})},roles:function(){return _(this.allChildren()).pluck("role")},allChildren:function(){var e,t;return e=this.components,t=_(this.subContainers()).invoke("allChildren"),_([e,t]).chain().compact().flatten().value()},findComponentForEventBinding:function(e,t){return t==null&&(t=!0),this.findComponentByName(e,t)||this.findComponentByGetter(e,t)||this.findComponentByRole(e,t)},findComponentByGetter:function(e,t){return t==null&&(t=!1),_(this.allChildren()).detect(function(t){return t.getter===e})},findComponentByRole:function(e,t){return t==null&&(t=!1),_(this.allChildren()).detect(function(t){return t.role===e||t.type===e||t.ctype===e})},findComponentByName:function(e,t){return t==null&&(t=!1),_(this.allChildren()).detect(function(t){return t.name===e})},findComponentById:function(e,t){return t==null&&(t=!1),this.findComponent(e,"cid_index",t)},findComponent:function(e,t,n){var r,i,s,o;t==null&&(t="name"),n==null&&(n=!1),this.componentsCreated!==!0&&this.createComponents(),i=(o=this.componentIndex)!=null?o[t][e]:void 0,r=this.components[i];if(r)return r;if(n===!0)return s=_(this.components).detect(function(n){return n!=null?typeof n.findComponent=="function"?n.findComponent(e,t,!0):void 0:void 0}),s!=null?typeof s.findComponent=="function"?s.findComponent(e,t,!0):void 0:void 0},each:function(e){return this.eachComponent(e,!1)},eachComponent:function(e,t){var n=this;return t==null&&(t=!0),_(this.components).each(function(n,r){var i;e.call(n,n,r);if(t)return n!=null?(i=n.eachComponent)!=null?i.apply(n,[e,t]):void 0:void 0})},indexOf:function(e){var t;return t=_(this.components).pluck("name"),_(t).indexOf(e)},activeComponent:function(){return this.activeItem?this.components[this.activeItem]:this},componentElements:function(){return this.$("[data-luca-parent='"+(this.name||this.cid)+"']")},getComponent:function(e){return this.components[e]},isRootComponent:function(){return this.getParent==null},getRootComponent:function(){return this.isRootComponent()?this:this.getParent().getRootComponent()},selectByAttribute:function(e,t,n){var r;return t==null&&(t=void 0),n==null&&(n=!1),r=_(this.components).map(function(r){var i,s;return i=[],s=r[e],(s===t||t==null&&s!=null)&&i.push(r),n===!0&&i.push(typeof r.selectByAttribute=="function"?r.selectByAttribute(e,t,!0):void 0),_.compact(i)}),_.flatten(r)}}),Luca.core.Container.componentRenderer=function(e,t){var n;return n=$(t.container)[t.attachWith||"append"],n(t.render().el)},s=function(){return this.trigger("before:layout",this),this.prepareLayout(),this.trigger("after:layout",this)},e=function(e,t){var n,r;return r=[],e.height!=null&&r.push("height: "+(_.isNumber(e.height)?e.height+"px":e.height)),e.width!=null&&r.push("width: "+(_.isNumber(e.width)?e.width+"px":e.width)),e.float&&r.push("float: "+e.float),n={"class":(e!=null?e.classes:void 0)||this.componentClass,id:""+this.cid+"-"+t,style:r.join(";"),"data-luca-parent":this.name||this.cid},this.customizeContainerEl!=null&&(n=this.customizeContainerEl(n,e,t)),n},n=function(){var e;return t=this,e=_(this.allChildren()).select(function(e){return e.getter!=null}),_(e).each(function(e){var n;return t[n=e.getter]||(t[n]=function(){return console.log(e.getter,e,t),e})})},r=function(){var e;return t=this,e=_(this.allChildren()).select(function(e){return e.role!=null}),_(e).each(function(e){var n;return n=_.str.camelize("get_"+e.role),t[n]||(t[n]=function(){return e})})},i=function(){return this.trigger("before:components",this,this.components),this.prepareComponents(),this.createComponents(),this.trigger("before:render:components",this,this.components),this.renderComponents(),this.trigger("after:components",this,this.components),this.skipGetterMethods!==!0&&(n.call(this),r.call(this)),this.registerComponentEvents()},u=function(){return!0},o=function(e){return{at:function(t){return{"in":function(n){e.cid!=null&&(n.cid_index[e.cid]=t),e.role!=null&&(n.role_index[e.role]=t);if(e.name!=null)return n.name_index[e.name]=t}}}}}}.call(this),function(){var e,t,n;Luca.CollectionManager=function(){function n(e){var n,r,i,s;this.options=e!=null?e:{},_.extend(this,this.options),r=this;if(n=typeof (i=Luca.CollectionManager).get=="function"?i.get(this.name):void 0)throw"Attempt to create a collection manager with a name which already exists";(s=Luca.CollectionManager).instances||(s.instances={}),_.extend(this,Backbone.Events),_.extend(this,Luca.Events),Luca.CollectionManager.instances[this.name]=r,Luca.CollectionManager.get=function(e){return e==null?r:Luca.CollectionManager.instances[e]},this.state=new Luca.Model,this.initialCollections&&t.call(this)}return n.prototype.name="primary",n.prototype.collectionNamespace=Luca.Collection.namespace,n.prototype.__collections={},n.prototype.relayEvents=!0,n.prototype.add=function(e,t){var n;return(n=this.currentScope())[e]||(n[e]=t)},n.prototype.allCollections=function(){return _(this.currentScope()).values()},n.prototype.create=function(t,n,r){var i,s,o;n==null&&(n={}),r==null&&(r=[]),i=n.base,i||(i=e.call(this,t)),n.private&&(n.name="");try{s=new i(r,n)}catch(u){throw console.log("Error creating collection",i,n,t),u}return this.add(t,s),o=this,this.relayEvents===!0&&this.bind("*",function(){return console.log("Relay Events on Collection Manager *",s,arguments)}),s},n.prototype.currentScope=function(){var e,t;return(e=this.getScope())?(t=this.__collections)[e]||(t[e]={}):this.__collections},n.prototype.each=function(e){return _(this.all()).each(e)},n.prototype.get=function(e){return this.currentScope()[e]},n.prototype.getScope=function(){return},n.prototype.destroy=function(e){var t;return t=this.get(e),delete this.currentScope()[e],t},n.prototype.getOrCreate=function(e,t,n){return t==null&&(t={}),n==null&&(n=[]),this.get(e)||this.create(e,t,n,!1)},n.prototype.collectionCountDidChange=function(){if(this.allCollectionsLoaded())return this.trigger("all_collections_loaded"),this.trigger("initial:load")},n.prototype.allCollectionsLoaded=function(){return this.totalCollectionsCount()===this.loadedCollectionsCount()},n.prototype.totalCollectionsCount=function(){return this.state.get("collections_count")},n.prototype.loadedCollectionsCount=function(){return this.state.get("loaded_collections_count")},n.prototype.private=function(e,t,n){return t==null&&(t={}),n==null&&(n=[]),this.create(e,t,n,!0)},n}(),Luca.CollectionManager.isRunning=function(){return _.isEmpty(Luca.CollectionManager.instances)!==!0},Luca.CollectionManager.destroyAll=function(){return Luca.CollectionManager.instances={}},Luca.CollectionManager.loadCollectionsByName=function(e,t){var n,r,i,s,o;o=[];for(i=0,s=e.length;i<s;i++)r=e[i],n=this.getOrCreate(r),n.once("reset",function(){return t(n)}),o.push(n.fetch());return o},e=function(e){var t,n,r,i;return t=Luca.util.classify(e),n=(this.collectionNamespace||window||global)[t],n||(n=(this.collectionNamespace||window||global)[""+t+"Collection"]),n==null&&((i=Luca.Collection.namespaces)!=null?i.length:void 0)>0&&(r=_(Luca.Collection.namespaces.reverse()).map(function(e){return Luca.util.resolve(""+e+"."+t)||Luca.util.resolve(""+e+"."+t+"Collection")}),r=_(r).compact(),r.length>0&&(n=r[0])),n},n=function(){var e,t,
n=this;return e=function(e){var t;return t=n.state.get("loaded_collections_count"),n.state.set("loaded_collections_count",t+1),n.trigger("collection_loaded",e.name),e.unbind("reset")},t=this.initialCollections,Luca.CollectionManager.loadCollectionsByName.call(this,t,e)},t=function(){var e=this;return this.state.set({loaded_collections_count:0,collections_count:this.initialCollections.length}),this.state.bind("change:loaded_collections_count",function(){return e.collectionCountDidChange()}),this.useProgressLoader&&(this.loaderView||(this.loaderView=new Luca.components.CollectionLoaderView({manager:this,name:"collection_loader_view"}))),n.call(this),this.initialCollectionsLoadedu,this}}.call(this),function(){Luca.SocketManager=function(){function e(e){this.options=e!=null?e:{},_.extend(Backbone.Events),this.loadTransport()}return e.prototype.connect=function(){switch(this.options.provider){case"socket.io":return this.socket=io.connect(this.options.socket_host);case"faye.js":return this.socket=new Faye.Client(this.options.socket_host)}},e.prototype.transportLoaded=function(){return this.connect()},e.prototype.transport_script=function(){switch(this.options.provider){case"socket.io":return""+this.options.transport_host+"/socket.io/socket.io.js";case"faye.js":return""+this.options.transport_host+"/faye.js"}},e.prototype.loadTransport=function(){var e,t=this;return e=document.createElement("script"),e.setAttribute("type","text/javascript"),e.setAttribute("src",this.transport_script()),e.onload=this.transportLoaded,Luca.util.isIE()&&(e.onreadystatechange=function(){if(e.readyState==="loaded")return t.transportLoaded()}),document.getElementsByTagName("head")[0].appendChild(e)},e}()}.call(this),function(){_.def("Luca.containers.SplitView")["extends"]("Luca.core.Container")["with"]({componentType:"split_view",containerTemplate:"containers/basic",className:"luca-ui-split-view",componentClass:"luca-ui-panel"})}.call(this),function(){_.def("Luca.containers.ColumnView")["extends"]("Luca.core.Container")["with"]({componentType:"column_view",className:"luca-ui-column-view",components:[],initialize:function(e){return this.options=e!=null?e:{},console.log("Column Views are deprecated in favor of just using grid css on a normal container"),Luca.core.Container.prototype.initialize.apply(this,arguments),this.setColumnWidths()},componentClass:"luca-ui-column",containerTemplate:"containers/basic",generateComponentElements:!0,autoColumnWidths:function(){var e,t=this;return e=[],_(this.components.length).times(function(){return e.push(parseInt(100/t.components.length))}),e},setColumnWidths:function(){return this.columnWidths=this.layout!=null?_(this.layout.split("/")).map(function(e){return parseInt(e)}):this.autoColumnWidths(),this.columnWidths=_(this.columnWidths).map(function(e){return""+e+"%"})},beforeLayout:function(){var e,t=this;return this.debug("column_view before layout"),_(this.columnWidths).each(function(e,n){return t.components[n].float="left",t.components[n].width=e}),(e=Luca.core.Container.prototype.beforeLayout)!=null?e.apply(this,arguments):void 0}})}.call(this),function(){var e;e=Luca.define("Luca.containers.CardView"),e["extends"]("Luca.core.Container"),e.defaults({className:"luca-ui-card-view-wrapper",activeCard:0,components:[],hooks:["before:card:switch","after:card:switch"],componentClass:"luca-ui-card",generateComponentElements:!0,initialize:function(e){return this.options=e,Luca.core.Container.prototype.initialize.apply(this,arguments),this.setupHooks(this.hooks),this.components||(this.components=this.pages||(this.pages=this.cards))},prepareComponents:function(){var e;return(e=Luca.core.Container.prototype.prepareComponents)!=null&&e.apply(this,arguments),this.componentElements().hide(),this.activeComponentElement().show()},activeComponentElement:function(){return this.componentElements().eq(this.activeCard)},activeComponent:function(){return this.getComponent(this.activeCard)},customizeContainerEl:function(e,t,n){return e.style+=n===this.activeCard?"display:block;":"display:none;",e},atFirst:function(){return this.activeCard===0},atLast:function(){return this.activeCard===this.components.length-1},next:function(){if(this.atLast())return;return this.activate(this.activeCard+1)},previous:function(){if(this.atFirst())return;return this.activate(this.activeCard-1)},cycle:function(){var e;return e=this.atLast()?0:this.activeCard+1,this.activate(e)},find:function(e){return Luca(e)},firstActivation:function(){return this.activeComponent().trigger("first:activation",this,this.activeComponent())},activate:function(e,t,n){var r,i,s,o,u,a,f=this;t==null&&(t=!1),_.isFunction(t)&&(t=!1,n=t);if(e===this.activeCard)return;i=this.activeComponent(),r=this.getComponent(e),r||(e=this.indexOf(e),r=this.getComponent(e));if(!r)return;t||(this.trigger("before:card:switch",i,r),i!=null&&(s=i.trigger)!=null&&s.apply(i,["before:deactivation",this,i,r]),r!=null&&(o=r.trigger)!=null&&o.apply(i,["before:activation",this,i,r]),_.defer(function(){return f.$el.data(f.activeAttribute||"active-card",r.name)})),this.componentElements().hide(),r.previously_activated||(r.trigger("first:activation"),r.previously_activated=!0),this.activeCard=e,this.activeComponentElement().show(),t||(this.trigger("after:card:switch",i,r),(u=i.trigger)!=null&&u.apply(i,["deactivation",this,i,r]),(a=r.trigger)!=null&&a.apply(r,["activation",this,i,r]));if(_.isFunction(n))return n.apply(this,[this,i,r])}})}.call(this),function(){_.def("Luca.ModalView")["extends"]("Luca.core.Container")["with"]({closeOnEscape:!0,showOnInitialize:!1,backdrop:!1,className:"luca-ui-container modal",container:function(){return $("body")},toggle:function(){return this.$el.modal("toggle")},show:function(){return this.$el.modal("show")},hide:function(){return this.$el.modal("hide")},render:function(){return this.$el.addClass("modal"),this.fade===!0&&this.$el.addClass("fade"),$("body").append(this.$el),this.$el.modal({backdrop:this.backdrop===!0,keyboard:this.closeOnEscape===!0,show:this.showOnInitialize===!0}),this}}),_.def("Luca.containers.ModalView")["extends"]("Luca.ModalView")["with"]()}.call(this),function(){_.def("Luca.PageView")["extends"]("Luca.containers.CardView")["with"]({version:2})}.call(this),function(){var e,t,n,r;n=Luca.register("Luca.components.PanelToolbar"),n["extends"]("Luca.View"),n.defines({buttons:[],className:"luca-ui-toolbar btn-toolbar",well:!0,orientation:"top",autoBindEventHandlers:!0,events:{"click a.btn, click .dropdown-menu li":"clickHandler"},initialize:function(e){var t;this.options=e!=null?e:{},this._super("initialize",this,arguments);if(this.group===!0&&((t=this.buttons)!=null?t.length:void 0)>=0)return this.buttons=[{group:!0,buttons:this.buttons}]},clickHandler:function(e){var t,n,r,i,s;r=i=$(e.target),r.is("i")&&(r=i=$(e.target).parent()),this.selectable===!0&&(i.siblings().removeClass("is-selected"),r.addClass("is-selected"));if(!(t=i.data("eventid")))return;return n=Luca.util.hook(t),s=this.parent||this,_.isFunction(s[n])?s[n].call(this,r,e):s.trigger(t,r,e)},beforeRender:function(){this._super("beforeRender",this,arguments),this.well===!0&&this.$el.addClass("well"),this.selectable===!0&&this.$el.addClass("btn-selectable"),this.$el.addClass("toolbar-"+this.orientation),this.align==="right"&&this.$el.addClass("pull-right");if(this.align==="left")return this.$el.addClass("pull-left")},render:function(){var e,t,n,i;this.$el.empty(),i=r(this.buttons);for(t=0,n=i.length;t<n;t++)e=i[t],this.$el.append(e);return this}}),t=Backbone.View.prototype.make,e=function(e,n){var i,s,o,u,a,f,l,c,h,p,d=this;n==null&&(n=!0);if(e.ctype!=null||e.type!=null){e.className||(e.className=""),e.className+="toolbar-component",c=Luca(e).render();if(Luca.isBackboneView(c))return c.$el}return e.spacer?t("div",{"class":"spacer "+e.spacer}):e.text?t("div",{"class":"toolbar-text"},e.text):(p="btn-group",e.wrapper!=null&&(p+=""+e.wrapper),e.align!=null&&(p+="pull-"+e.align+" align-"+e.align),e.selectable===!0&&(p+="btn-selectable"),e.group!=null&&e.buttons!=null?(u=r(e.buttons,!1),t("div",{"class":p},u)):(l=e.label||(e.label=""),e.eventId||(e.eventId=_.string.dasherize(e.label.toLowerCase())),e.icon&&(_.string.isBlank(l)&&(l=" "),e.white&&(h="icon-white"),l="<i class='"+(h||"")+" icon-"+e.icon+"' /> "+l),s={"class":_.compact(["btn",e.classes,e.className]).join(" "),"data-eventId":e.eventId,title:e.title||e.description},e.color!=null&&(s["class"]+=" btn-"+e.color),e.selected!=null&&(s["class"]+=" is-selected"),e.dropdown&&(l=""+l+" <span class='caret'></span>",s["class"]+=" dropdown-toggle",s["data-toggle"]="dropdown",f=_(e.dropdown).map(function(e){var n;return n=t("a",{},e[1]),t("li",{"data-eventId":e[0]},n)}),a=t("ul",{"class":"dropdown-menu"},f)),o=t("a",s,l),i="btn-group",e.align!=null&&(i+=" align-"+e.align),n===!0?t("div",{"class":i},[o,a]):o))},r=function(t,n){var r,i,s,o;t==null&&(t=[]),n==null&&(n=!0),o=[];for(i=0,s=t.length;i<s;i++)r=t[i],o.push(e(r,n));return o}}.call(this),function(){_.def("Luca.containers.PanelView")["extends"]("Luca.core.Container")["with"]({className:"luca-ui-panel",initialize:function(e){return this.options=e!=null?e:{},Luca.core.Container.prototype.initialize.apply(this,arguments)},afterLayout:function(){var e;if(this.template)return e=(Luca.templates||JST)[this.template](this),this.$el.html(e)},render:function(){return $(this.container).append(this.$el)},afterRender:function(){var e,t=this;(e=Luca.core.Container.prototype.afterRender)!=null&&e.apply(this,arguments);if(this.css)return _(this.css).each(function(e,n){return t.$el.css(n,e)})}})}.call(this),function(){_.def("Luca.containers.TabView")["extends"]("Luca.containers.CardView")["with"]({hooks:["before:select","after:select"],componentType:"tab_view",className:"luca-ui-tab-view tabbable",tab_position:"top",tabVerticalOffset:"50px",navClass:"nav-tabs",bodyTemplate:"containers/tab_view",bodyEl:"div.tab-content",initialize:function(e){return this.options=e!=null?e:{},this.navStyle==="list"&&(this.navClass="nav-list"),Luca.containers.CardView.prototype.initialize.apply(this,arguments),_.bindAll(this,"select","highlightSelectedTab"),this.setupHooks(this.hooks),this.bind("after:card:switch",this.highlightSelectedTab)},activeTabSelector:function(){return this.tabSelectors().eq(this.activeCard||this.activeTab||this.activeItem)},beforeLayout:function(){var e;return this.$el.addClass("tabs-"+this.tab_position),this.activeTabSelector().addClass("active"),this.createTabSelectors(),(e=Luca.containers.CardView.prototype.beforeLayout)!=null?e.apply(this,arguments):void 0},afterRender:function(){var e,t;(t=Luca.containers.CardView.prototype.afterRender)!=null&&t.apply(this,arguments),e=this.tabContainer().attr("id"),this.registerEvent("click #"+e+" li a","select");if(Luca.enableBootstrap&&(this.tab_position==="left"||this.tab_position==="right"))return this.tabContainerWrapper().addClass("span2"),this.tabContentWrapper().addClass("span9")},createTabSelectors:function(){var e;return e=this,this.each(function(t,n){var r,i,s,o;t.tabIcon&&(r="<i class='icon-"+t.tabIcon+"'></i>"),i="<a href='#'>"+(r||"")+" "+t.title+"</a>",s=e.make("li",{"class":"tab-selector","data-target":n},i),e.tabContainer().append(s);if(t.navHeading!=null&&((o=e.navHeadings)!=null?!o[t.navHeading]:!void 0))return $(s).before(e.make("li",{"class":"nav-header"},t.navHeading)),e.navHeadings||(e.navHeadings={}),e.navHeadings[t.navHeading]=!0})},highlightSelectedTab:function(){return this.tabSelectors().removeClass("active"),this.activeTabSelector().addClass("active")},select:function(e){var t,n;return e.preventDefault(),t=n=$(e.target),this.trigger("before:select",this),this.activate(n.parent().data("target")),this.trigger("after:select",this)},componentElements:function(){return this.$(">.tab-content >."+this.componentClass)},tabContentWrapper:function(){return $("#"+this.cid+"-tab-view-content")},tabContainerWrapper:function(){return $("#"+this.cid+"-tabs-selector")},tabContainer:function(){return this.$("ul."+this.navClass,this.tabContainerWrapper())},tabSelectors:function(){return this.$("li.tab-selector",this.tabContainer())}})}.call(this),function(){_.def("Luca.containers.Viewport").extend("Luca.containers.CardView")["with"]({activeItem:0,additionalClassNames:"luca-ui-viewport",fullscreen:!0,fluid:!1,initialize:function(e){this.options=e!=null?e:{},_.extend(this,this.options),Luca.enableBootstrap===!0&&(this.wrapperClass=this.fluid===!0?Luca.containers.Viewport.fluidWrapperClass:Luca.containers.Viewport.defaultWrapperClass),Luca.core.Container.prototype.initialize.apply(this,arguments);if(this.fullscreen===!0)return this.enableFullscreen()},enableFluid:function(){return this.enableWrapper()},disableFluid:function(){return this.disableWrapper()},enableWrapper:function(){if(this.wrapperClass!=null)return this.$el.parent().addClass(this.wrapperClass)},disableWrapper:function(){if(this.wrapperClass!=null)return this.$el.parent().removeClass(this.wrapperClass)},enableFullscreen:function(){return $("html,body").addClass("luca-ui-fullscreen"),this.$el.addClass("fullscreen-enabled")},disableFullscreen:function(){return $("html,body").removeClass("luca-ui-fullscreen"),this.$el.removeClass("fullscreen-enabled")},beforeRender:function(){var e;(e=Luca.containers.CardView.prototype.beforeRender)!=null&&e.apply(this,arguments),this.topNav!=null&&this.renderTopNavigation();if(this.bottomNav!=null)return this.renderBottomNavigation()},height:function(){return this.$el.height()},width:function(){return this.$el.width()},afterRender:function(){var e;(e=Luca.containers.CardView.prototype.after)!=null&&e.apply(this,arguments);if(Luca.enableBootstrap===!0&&this.containerClassName)return this.$el.children().wrap('<div class="#{ containerClassName }" />')},renderTopNavigation:function(){var e;if(this.topNav==null)return;return _.isString(this.topNav)&&(this.topNav=Luca.util.lazyComponent(this.topNav)),_.isObject(this.topNav)&&((e=this.topNav).ctype||(e.ctype=this.topNav.type||"nav_bar"),Luca.isBackboneView(this.topNav)||(this.topNav=Luca.util.lazyComponent(this.topNav))),this.topNav.app=this,$("body").prepend(this.topNav.render().el)},renderBottomNavigation:function(){}}),Luca.containers.Viewport.defaultWrapperClass="row",Luca.containers.Viewport.fluidWrapperClass="row-fluid"}.call(this),function(){_.def("Luca.components.Template")["extends"]("Luca.View")["with"]({initialize:function(e){return this.options=e!=null?e:{},console.log("The Use of Luca.components.Template directly is being DEPRECATED"),Luca.View.prototype.initialize.apply(this,arguments)}})}.call(this),function(){Luca.util.startHistory=function(){return Backbone.history.start()},_.def("Luca.Application")["extends"]("Luca.containers.Viewport")["with"]({name:"MyApp",defaultState:{},autoBoot:!1,autoStartHistory:"before:render",useCollectionManager:!0,collectionManager:{},collectionManagerClass:"Luca.CollectionManager",plugin:!1,useController:!0,useKeyHandler:!1,keyEvents:{},components:[{ctype:"template",name:"welcome",template:"sample/welcome",templateContainer:"Luca.templates"}],initialize:function(e){var t,n,r,i,s=this;this.options=e!=null?e:{},n=this,r=this.name,t=typeof Luca.getApplication=="function"?Luca.getApplication():void 0,(i=Luca.Application).instances||(i.instances={}),Luca.Application.instances[r]=n,Luca.containers.Viewport.prototype.initialize.apply(this,arguments),this.state=new Luca.Model(this.defaultState),this.useController===!0&&this.setupMainController(),this.setupCollectionManager(),this.defer(function(){return n.render()}).until(this,"ready"),this.setupRouter(),this.useKeyRouter===!0&&console.log("The useKeyRouter property is being deprecated. switch to useKeyHandler instead"),(this.useKeyHandler===!0||this.useKeyRouter===!0)&&this.keyEvents!=null&&this.setupKeyHandler(),this.plugin!==!0&&!t&&(Luca.getApplication=function(e){return e==null?n:Luca.Application.instances[e]});if(this.autoBoot){if(Luca.util.resolve(this.name))throw"Attempting to override window."+this.name+" when it already exists";return $(function(){return window[r]=n,n.boot()})}},activeView:function(){var e;return(e=this.activeSubSection())?this.view(e):this.view(this.activeSection())},activeSection:function(){return this.get("active_section")},activeSubSection:function(){return this.get("active_sub_section")},activePages:function(){var e=this;return this.$(".luca-ui-controller").map(function(e,t){return $(t).data("active-section")})},boot:function(){return this.trigger("ready")},collection:function(){return this.collectionManager.getOrCreate.apply(this.collectionManager,arguments)},get:function(e){return this.state.get(e)},set:function(e,t,n){return this.state.set.apply(this.state,arguments)},view:function(e){return Luca.cache(e)},navigate_to:function(e,t){return this.getMainController().navigate_to(e,t)},getMainController:function(){return this.useController===!0?this.components[0]:Luca.cache("main_controller")},keyHandler:function(e){var t,n,r,i,s,o,u;if(!e||!this.keyEvents)return;n=$(e.target).is("input")||$(e.target).is("textarea");if(n)return;i=Luca.keyMap[e.keyCode];if(!i)return;s=(e!=null?e.metaKey:void 0)===!0,t=(e!=null?e.ctrlKey:void 0)===!0,o=this.keyEvents,o=s?this.keyEvents.meta:o,o=t?this.keyEvents.control:o,o=s&&t?this.keyEvents.meta_control:o;if(r=o!=null?o[i]:void 0)return this[r]!=null&&_.isFunction(this[r])?(u=this[r])!=null?u.call(this):void 0:this.trigger(r,e,i)},setupControllerBindings:function(){var e,t,n,r=this;return e=this,(t=this.getMainController())!=null&&t.bind("after:card:switch",function(t,n){return r.state.set({active_section:n.name}),e.trigger("page:change")}),(n=this.getMainController())!=null?n.each(function(t){var n;n=t.type||t.type;if(n.match(/controller$/))return t.bind("after:card:switch",function(t,n){return r.state.set({active_sub_section:n.name}),e.trigger("sub:page:change")})}):void 0},setupMainController:function(){var e;if(this.useController===!0)return e=this.components||[],this.components=[{type:"controller",name:"main_controller",components:e}],this.defer(this.setupControllerBindings,!1).until("after:components")},setupCollectionManager:function(){var e,t,n,r,i;if(this.useCollectionManager!==!0)return;if(this.collectionManager!=null&&((n=this.collectionManager)!=null?n.get:void 0)!=null)return;_.isString(this.collectionManagerClass)&&(this.collectionManagerClass=Luca.util.resolve(this.collectionManagerClass)),e=this.collectionManagerOptions||{},_.isObject(this.collectionManager)&&!_.isFunction((r=this.collectionManager)!=null?r.get:void 0)&&(e=this.collectionManager,this.collectionManager=void 0),_.isString(this.collectionManager)&&(e={name:this.collectionManager}),this.collectionManager=typeof (t=Luca.CollectionManager).get=="function"?t.get(e.name):void 0;if(!_.isFunction((i=this.collectionManager)!=null?i.get:void 0))return this.collectionManager=new this.collectionManagerClass(e)},setupRouter:function(){var e,t;e=this,_.isString(this.router)&&(t=Luca.util.resolve(this.router),this.router=new t({app:e}));if(this.router&&this.autoStartHistory)return this.autoStartHistory===!0&&(this.autoStartHistory="before:render"),this.defer(Luca.util.startHistory,!1).until(this,this.autoStartHistory)},setupKeyHandler:function(){var e,t,n,r,i,s,o;if(!this.keyEvents)return;(n=this.keyEvents).control_meta||(n.control_meta={}),this.keyEvents.meta_control&&_.extend(this.keyEvents.control_meta,this.keyEvents.meta_control),e=_.bind(this.keyHandler,this),s=this.keypressEvents||["keydown"],o=[];for(r=0,i=s.length;r<i;r++)t=s[r],o.push($(document).on(t,e));return o}})}.call(this),function(){_.def("Luca.components.Toolbar")["extends"]("Luca.core.Container")["with"]({className:"luca-ui-toolbar toolbar",position:"bottom",initialize:function(e){return this.options=e!=null?e:{},Luca.core.Container.prototype.initialize.apply(this,arguments)},prepareComponents:function(){var e=this;return _(this.components).each(function(t){return t.container=e.$el})},render:function(){return $(this.container).append(this.el)}})}.call(this),function(){_.def("Luca.components.CollectionLoaderView")["extends"]("Luca.components.Template")["with"]({className:"luca-ui-collection-loader-view",template:"components/collection_loader_view",initialize:function(e){return this.options=e!=null?e:{},Luca.components.Template.prototype.initialize.apply(this,arguments),this.container||(this.container=$("body")),this.manager||(this.manager=Luca.CollectionManager.get()),this.setupBindings()},modalContainer:function(){return $("#progress-modal",this.el)},setupBindings:function(){var e=this;return this.manager.bind("collection_loaded",function(t){var n,r,i,s;return r=e.manager.loadedCollectionsCount(),s=e.manager.totalCollectionsCount(),i=parseInt(r/s*100),n=_.string.titleize(_.string.humanize(t)),e.modalContainer().find(".progress .bar").attr("style","width: "+i+"%;"),e.modalContainer().find(".message").html("Loaded "+n+"...")}),this.manager.bind("all_collections_loaded",function(){return e.modalContainer().find(".message").html("All done!"),_.delay(function(){return e.modalContainer().modal("hide")},400)})}})}.call(this),function(){var e,t;e=Luca.define("Luca.components.CollectionView"),e["extends"]("Luca.components.Panel"),e.behavesAs("LoadMaskable","Filterable","Paginatable"),e.triggers("before:refresh","after:refresh","refresh","empty:results"),e.defaults({tagName:"ol",className:"luca-ui-collection-view",bodyClassName:"collection-ui-panel",itemTemplate:void 0,itemRenderer:void 0,itemTagName:"li",itemClassName:"collection-item",initialize:function(e){var t=this;this.options=e!=null?e:{},_.extend(this,this.options),_.bindAll(this,"refresh");if(this.collection==null&&!this.options.collection)throw console.log("Error on initialize of collection view",this),"Collection Views must specify a collection";if(this.itemTemplate==null&&this.itemRenderer==null&&this.itemProperty==null)throw"Collection Views must specify an item template or item renderer function";_.isString(this.collection)&&(Luca.CollectionManager.get()?this.collection=Luca.CollectionManager.get().getOrCreate(this.collection):console.log("String Collection but no collection manager"));if(!Luca.isBackboneCollection(this.collection))throw console.log("Missing Collection on "+(this.name||this.cid),this,this.collection),"Collection Views must have a valid backbone collection";return Luca.components.Panel.prototype.initialize.apply(this,arguments),this.autoRefreshOnModelsPresent!==!1&&this.defer(function(){if(t.collection.length>0)return t.refresh()}).until("after:render"),this.on("refresh",this.refresh,this)},attributesForItem:function(e,t){return _.extend({},{"class":this.itemClassName,"data-index":e.index,"data-model-id":e.model.get("id")})},contentForItem:function(e){var t,n;return e==null&&(e={}),this.itemTemplate!=null&&(n=Luca.template(this.itemTemplate))?t=n.call(this,e):this.itemRenderer!=null&&_.isFunction(this.itemRenderer)?t=this.itemRenderer.call(this,e,e.model,e.index):this.itemProperty&&e.model!=null?t=e.model.read(this.itemProperty):""},makeItem:function(e,n){var r,i,s;s=this.prepareItem!=null?this.prepareItem.call(this,e,n):{model:e,index:n},r=this.attributesForItem(s,e),i=this.contentForItem(s);try{return t(this.itemTagName,r,i)}catch(o){return console.log("Error generating DOM element for CollectionView",this,e,n)}},getCollection:function(){return this.collection},applyQuery:function(e,t){return e==null&&(e={}),t==null&&(t={}),this.query=e,this.queryOptions=t,this.refresh(),this},getQuery:function(){var e,t,n,r,i;e=this.query||(this.query={}),i=_(this.querySources||[]).compact();for(n=0,r=i.length;n<r;n++)t=i[n],e=_.extend(e,t()||{});return e},getQueryOptions:function(){var e,t,n,r,i;t=this.queryOptions||(this.queryOptions={}),i=_(this.optionsSources||[]).compact();for(n=0,r=i.length;n<r;n++)e=i[n],t=_.extend(t,e()||{});return t},getModels:function(e,t){var n;return((n=this.collection)!=null?n.query:void 0)?(e||(e=this.getQuery()),t||(t=this.getQueryOptions()),this.collection.query(e,t)):this.collection.models},locateItemElement:function(e){return this.$("."+this.itemClassName+"[data-model-id='"+e+"']")},refreshModel:function(e){var t;return t=this.collection.indexOf(e),this.locateItemElement(e.get("id")).empty().append(this.contentForItem({model:e,index:t},e)),this.trigger("model:refreshed",t,e)},refresh:function(e,t,n){var r,i,s,o;e||(e=this.getQuery()),t||(t=this.getQueryOptions()),n||(n=this.getModels(e,t)),this.$bodyEl().empty(),this.trigger("before:refresh",n,e,t),n.length===0&&this.trigger("empty:results"),r=0;for(s=0,o=n.length;s<o;s++)i=n[s],this.$append(this.makeItem(i,r++));return this.trigger("after:refresh",n,e,t),this},registerEvent:function(e,t,n){var r;return n==null&&_.isFunction(t)&&(n=t,t=void 0),r=_([e,""+this.itemTagName+"."+this.itemClassName,t]).compact().join(" "),Luca.View.prototype.registerEvent(r,n)},render:function(){return this.refresh(),this.$el.parent().length>0&&this.container!=null&&this.$attach(),this}}),t=Luca.View.prototype.make}.call(this),function(){_.def("Luca.components.Controller")["extends"]("Luca.containers.CardView")["with"]({additionalClassNames:["luca-ui-controller"],activeAttribute:"active-section",initialize:function(e){var t;this.options=e,Luca.containers.CardView.prototype.initialize.apply(this,arguments),this.defaultCard||(this.defaultCard=(t=this.components[0])!=null?t.name:void 0);if(!this.defaultCard)throw"Controllers must specify a defaultCard property and/or the first component must have a name";return this.state=new Backbone.Model({active_section:this.defaultCard})},each:function(e){var t=this;return _(this.components).each(function(n){return e.apply(t,[n])})},activeSection:function(){return this.get("activeSection")},controllers:function(e){return e==null&&(e=!1),this.select("ctype","controller",e)},availableSections:function(){var e,t=this;return e={},e[this.name]=this.sectionNames(),_(this.controllers()).reduce(function(e,t){return e[t.name]=t.sectionNames(),e},e)},sectionNames:function(e){return e==null&&(e=!1),this.pluck("name")},"default":function(e){return this.navigate_to(this.defaultCard,e)},navigate_to:function(e,t){var n=this;return e||(e=this.defaultCard),this.activate(e,!1,function(e,r,i){n.state.set({active_section:i.name});if(_.isFunction(t))return t.apply(i)}),this.find(e)}})}.call(this),function(){_.def("Luca.fields.ButtonField")["extends"]("Luca.core.Field")["with"]({readOnly:!0,events:{"click input":"click_handler"},hooks:["button:click"],className:"luca-ui-field luca-ui-button-field",template:"fields/button_field",click_handler:function(e){var t,n;return t=n=$(e.currentTarget),this.trigger("button:click")},initialize:function(e){var t;this.options=e!=null?e:{},_.extend(this.options),_.bindAll(this,"click_handler"),Luca.core.Field.prototype.initialize.apply(this,arguments);if((t=this.icon_class)!=null?t.length:void 0)return this.template="fields/button_field_link"},afterInitialize:function(){this.input_id||(this.input_id=_.uniqueId("button")),this.input_name||(this.input_name=this.name||(this.name=this.input_id)),this.input_value||(this.input_value=this.label||(this.label=this.text)),this.input_type||(this.input_type="button"),this.input_class||(this.input_class=this["class"]),this.icon_class||(this.icon_class=""),this.icon_class.length&&!this.icon_class.match(/^icon-/)&&(this.icon_class="icon-"+this.icon_class);if(this.white)return this.icon_class+=" icon-white"},setValue:function(){return!0}})}.call(this),function(){var e;e=Luca.View.prototype.make,_.def("Luca.fields.CheckboxArray")["extends"]("Luca.core.Field")["with"]({version:2,template:"fields/checkbox_array",className:"luca-ui-checkbox-array",events:{"click input":"clickHandler"},selectedItems:[],initialize:function(e){return this.options=e!=null?e:{},_.extend(this,this.options),_.extend(this,Luca.modules.Deferrable),_.bindAll(this,"renderCheckboxes","clickHandler","checkSelected"),Luca.core.Field.prototype.initialize.apply(this,arguments),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name),this.valueField||(this.valueField="id"),this.displayField||(this.displayField="name")},afterInitialize:function(e){var t;this.options=e!=null?e:{};try{this.configure_collection()}catch(n){console.log("Error Configuring Collection",this,n.message)}return t=this,this.collection.length>0?this.renderCheckboxes():this.defer("renderCheckboxes").until(this.collection,"reset")},clickHandler:function(e){var t;t=$(e.target);if(t.prop("checked"))return this.selectedItems.push(t.val());if(_(this.selectedItems).include(t.val()))return this.selectedItems=_(this.selectedItems).without(t.val())},controls:function(){return this.$(".controls")},renderCheckboxes:function(){var t=this;return this.controls().empty(),this.selectedItems=[],this.collection.each(function(n){var r,i,s,o,u;return u=n.get(t.valueField),o=n.get(t.displayField),s=_.uniqueId(""+t.cid+"_checkbox"),i=e("input",{type:"checkbox","class":"array-checkbox",name:t.input_name,value:u,id:s}),r=e("label",{"for":s},i),$(r).append(" "+o),t.controls().append(r)}),this.trigger("checkboxes:rendered",this.checkboxesRendered=!0),this},uncheckAll:function(){return this.allFields().prop("checked",!1)},allFields:function(){return this.controls().find("input[type='checkbox']")},checkSelected:function(e){var t,n,r,i,s;e!=null&&(this.selectedItems=e),this.uncheckAll(),s=this.selectedItems;for(r=0,i=s.length;r<i;r++)n=s[r],t=this.controls().find("input[value='"+n+"']"),t.prop("checked",!0);return this.selectedItems},getValue:function(){var e,t,n,r,i;r=this.allFields(),i=[];for(t=0,n=r.length;t<n;t++)e=r[t],this.$(e).prop("checked")&&i.push(this.$(e).val());return i},setValue:function(e){var t;return this.selectedItems=e,this.checkboxesRendered===!0?this.checkSelected(e):(t=this,this.defer(function(){return t.checkSelected(e)}).until("checkboxes:rendered"))},getValues:function(){return this.getValue()},setValues:function(e){return this.setValue(e)}})}.call(this),function(){_.def("Luca.fields.CheckboxField")["extends"]("Luca.core.Field")["with"]({events:{"change input":"change_handler"},className:"luca-ui-checkbox-field luca-ui-field",template:"fields/checkbox_field",hooks:["checked","unchecked"],send_blanks:!0,change_handler:function(e){var t,n;return t=n=$(e.target),t.is(":checked")?this.trigger("checked"):this.trigger("unchecked"),this.trigger("on:change",this,e,t.is(":checked"))},initialize:function(e){return this.options=e!=null?e:{},_.extend(this,this.options),_.bindAll(this,"change_handler"),Luca.core.Field.prototype.initialize.apply(this,arguments)},afterInitialize:function(){return this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.input_value||(this.input_value=1),this.label||(this.label=this.name)},setValue:function(e){return this.getInputElement().attr("checked",e)},getValue:function(){return this.getInputElement().is(":checked")}})}.call(this),function(){_.def("Luca.fields.FileUploadField")["extends"]("Luca.core.Field")["with"]({template:"fields/file_upload_field",afterInitialize:function(){return this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name),this.helperText||(this.helperText="")}})}.call(this),function(){_.def("Luca.fields.HiddenField")["extends"]("Luca.core.Field")["with"]({template:"fields/hidden_field",afterInitialize:function(){return this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.input_value||(this.input_value=this.value),this.label||(this.label=this.name)}})}.call(this),function(){_.def("Luca.components.LabelField")["extends"]("Luca.core.Field")["with"]({className:"luca-ui-field luca-ui-label-field",formatter:function(e){return e||(e=this.getValue()),_.str.titleize(e)},setValue:function(e){return this.trigger("change",e,this.getValue()),this.getInputElement().attr("value",e),this.$(".value").html(this.formatter(e))}})}.call(this),function(){_.def("Luca.fields.SelectField")["extends"]("Luca.core.Field")["with"]({events:{"change select":"change_handler"},hooks:["after:select"],className:"luca-ui-select-field luca-ui-field",template:"fields/select_field",includeBlank:!0,blankValue:"",blankText:"Select One",initialize:function(e){this.options=e!=null?e:{},_.extend(this,this.options),_.extend(this,Luca.modules.Deferrable),_.bindAll(this,"change_handler","populateOptions","beforeFetch"),Luca.core.Field.prototype.initialize.apply(this,arguments),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name);if(_.isUndefined(this.retainValue))return this.retainValue=!0},afterInitialize:function(){var e
;if((e=this.collection)!=null?e.data:void 0)this.valueField||(this.valueField="id"),this.displayField||(this.displayField="name"),this.parseData();try{this.configure_collection()}catch(t){console.log("Error Configuring Collection",this,t.message)}return this.collection.bind("before:fetch",this.beforeFetch),this.collection.bind("reset",this.populateOptions)},parseData:function(){var e=this;return this.collection.data=_(this.collection.data).map(function(t){var n;return _.isArray(t)?(n={},n[e.valueField]=t[0],n[e.displayField]=t[1]||t[0],n):t})},getInputElement:function(){return this.input||(this.input=this.$("select").eq(0))},afterRender:function(){var e,t;return((e=this.collection)!=null?(t=e.models)!=null?t.length:void 0:void 0)>0?this.populateOptions():this.collection.trigger("reset")},setValue:function(e){return this.currentValue=e,Luca.core.Field.prototype.setValue.apply(this,arguments)},beforeFetch:function(){return this.resetOptions()},change_handler:function(e){return this.trigger("on:change",this,e)},resetOptions:function(){this.getInputElement().html("");if(this.includeBlank)return this.getInputElement().append("<option value='"+this.blankValue+"'>"+this.blankText+"</option>")},populateOptions:function(){var e,t=this;return this.resetOptions(),((e=this.collection)!=null?e.each:void 0)!=null&&this.collection.each(function(e){var n,r,i,s;return s=e.get(t.valueField),n=e.get(t.displayField),t.selected&&s===t.selected&&(i="selected"),r="<option "+i+" value='"+s+"'>"+n+"</option>",t.getInputElement().append(r)}),this.trigger("after:populate:options",this),this.setValue(this.currentValue)}})}.call(this),function(){_.def("Luca.fields.TextAreaField")["extends"]("Luca.core.Field")["with"]({events:{"keydown input":"keydown_handler","blur input":"blur_handler","focus input":"focus_handler"},template:"fields/text_area_field",height:"200px",width:"90%",initialize:function(e){return this.options=e!=null?e:{},_.bindAll(this,"keydown_handler"),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name),this.input_class||(this.input_class=this["class"]),this.input_value||(this.input_value=""),this.inputStyles||(this.inputStyles="height:"+this.height+";width:"+this.width),this.placeHolder||(this.placeHolder=this.placeHolder),Luca.core.Field.prototype.initialize.apply(this,arguments)},setValue:function(e){return $(this.field()).val(e)},getValue:function(){return $(this.field()).val()},field:function(){return this.input=$("textarea#"+this.input_id,this.el)},keydown_handler:function(e){var t,n;return t=n=$(e.currentTarget)},blur_handler:function(e){var t,n;return t=n=$(e.currentTarget)},focus_handler:function(e){var t,n;return t=n=$(e.currentTarget)}})}.call(this),function(){_.def("Luca.fields.TextField")["extends"]("Luca.core.Field")["with"]({events:{"blur input":"blur_handler","focus input":"focus_handler","change input":"change_handler"},template:"fields/text_field",autoBindEventHandlers:!0,send_blanks:!0,keyEventThrottle:300,initialize:function(e){return this.options=e!=null?e:{},this.enableKeyEvents&&this.registerEvent("keyup input","keyup_handler"),this.input_id||(this.input_id=_.uniqueId("field")),this.input_name||(this.input_name=this.name),this.label||(this.label=this.name),this.input_class||(this.input_class=this["class"]),this.input_value||(this.input_value=this.value||""),this.placeHolder||(this.placeHolder=this.placeHolder),this.prepend&&(this.$el.addClass("input-prepend"),this.addOn=this.prepend),this.append&&(this.$el.addClass("input-append"),this.addOn=this.append),Luca.core.Field.prototype.initialize.apply(this,arguments)},keyup_handler:function(e){return this.trigger("on:keyup",this,e)},blur_handler:function(e){return this.trigger("on:blur",this,e)},focus_handler:function(e){return this.trigger("on:focus",this,e)},change_handler:function(e){return this.trigger("on:change",this,e)}})}.call(this),function(){_.def("Luca.fields.TypeAheadField")["extends"]("Luca.fields.TextField")["with"]({className:"luca-ui-field",getSource:function(){return Luca.util.read(this.source)||[]},matcher:function(e){return!0},beforeRender:function(){return Luca.fields.TextField.prototype.beforeRender.apply(this,arguments),this.getInputElement().attr("data-provide","typeahead")},afterRender:function(){return Luca.fields.TextField.prototype.afterRender.apply(this,arguments),this.getInputElement().typeahead({matcher:this.matcher,source:this.getSource()})}})}.call(this),function(){_.def("Luca.components.FormButtonToolbar")["extends"]("Luca.components.Toolbar")["with"]({className:"luca-ui-form-toolbar form-actions",position:"bottom",includeReset:!1,render:function(){return $(this.container).append(this.el)},initialize:function(e){this.options=e!=null?e:{},Luca.components.Toolbar.prototype.initialize.apply(this,arguments),this.components=[{ctype:"button_field",label:"Submit","class":"btn submit-button"}];if(this.includeReset)return this.components.push({ctype:"button_field",label:"Reset","class":"btn reset-button"})}})}.call(this),function(){_.def("Luca.components.FormView")["extends"]("Luca.core.Container")["with"]({tagName:"form",className:"luca-ui-form-view",hooks:["before:submit","before:reset","before:load","before:load:new","before:load:existing","after:submit","after:reset","after:load","after:load:new","after:load:existing","after:submit:success","after:submit:fatal_error","after:submit:error"],events:{"click .submit-button":"submitHandler","click .reset-button":"resetHandler"},toolbar:!0,legend:"",bodyClassName:"form-view-body",version:"0.9.33333333",initialize:function(e){this.options=e!=null?e:{},this.loadMask==null&&(this.loadMask=Luca.enableBootstrap),Luca.core.Container.prototype.initialize.apply(this,arguments),this.components||(this.components=this.fields),_.bindAll(this,"submitHandler","resetHandler","renderToolbars","applyLoadMask"),this.state||(this.state=new Backbone.Model),this.setupHooks(this.hooks),this.applyStyleClasses();if(this.toolbar!==!1&&!this.topToolbar&&!this.bottomToolbar){if(this.toolbar==="both"||this.toolbar==="top")this.topToolbar=this.getDefaultToolbar();if(this.toolbar!=="top")return this.bottomToolbar=this.getDefaultToolbar()}},getDefaultToolbar:function(){return Luca.components.FormView.defaultFormViewToolbar},applyStyleClasses:function(){Luca.enableBootstrap&&this.applyBootstrapStyleClasses(),this.labelAlign&&this.$el.addClass("label-align-"+this.labelAlign);if(this.fieldLayoutClass)return this.$el.addClass(this.fieldLayoutClass)},applyBootstrapStyleClasses:function(){this.labelAlign==="left"&&(this.inlineForm=!0),this.well&&this.$el.addClass("well"),this.searchForm&&this.$el.addClass("form-search"),this.horizontalForm&&this.$el.addClass("form-horizontal");if(this.inlineForm)return this.$el.addClass("form-inline")},resetHandler:function(e){var t,n;return t=n=$(e!=null?e.target:void 0),this.trigger("before:reset",this),this.reset(),this.trigger("after:reset",this)},submitHandler:function(e){var t,n;t=n=$(e!=null?e.target:void 0),this.trigger("before:submit",this),this.loadMask===!0&&this.trigger("enable:loadmask",this);if(this.hasModel())return this.submit()},afterComponents:function(){var e,t=this;return(e=Luca.core.Container.prototype.afterComponents)!=null&&e.apply(this,arguments),this.eachField(function(e){return e.getForm=function(){return t},e.getModel=function(){return t.currentModel()}})},eachField:function(e){return _(this.getFields()).map(e)},getField:function(e){var t;return t=_(this.getFields("name",e)).first(),t!=null?t:_(this.getFields("input_name",e)).first()},getFields:function(e,t){var n;return n=this.selectByAttribute("isField",!0,!0),e!=null&&t!=null&&(n=_(n).select(function(n){var r;return r=n[e],_.isFunction(r)&&(r=r.call(n)),r===t})),n},loadModel:function(e){var t,n,r,i;this.current_model=e,r=this,n=this.getFields(),this.trigger("before:load",this,this.current_model),this.current_model&&((i=this.current_model.beforeFormLoad)!=null&&i.apply(this.current_model,this),t="before:load:"+(this.current_model.isNew()?"new":"existing"),this.trigger(t,this,this.current_model)),this.setValues(this.current_model),this.trigger("after:load",this,this.current_model);if(this.current_model)return this.trigger("after:load:"+(this.current_model.isNew()?"new":"existing"),this,this.current_model)},reset:function(){if(this.current_model!=null)return this.loadModel(this.current_model)},clear:function(){var e=this;return this.current_model=this.defaultModel!=null?this.defaultModel():void 0,_(this.getFields()).each(function(t){try{return t.setValue("")}catch(n){return console.log("Error Clearing",e,t)}})},setValues:function(e,t){var n,r=this;t==null&&(t={}),e||(e=this.currentModel()),n=this.getFields(),_(n).each(function(t){var n,i;n=t.input_name||t.name,(i=e[n])&&_.isFunction(i)&&(i=i.apply(r)),!i&&Luca.isBackboneModel(e)&&(i=e.get(n));if(t.readOnly!==!0)return t!=null?t.setValue(i):void 0});if(t.silent!=null!=1)return this.syncFormWithModel()},getValues:function(e){var t,n=this;return e==null&&(e={}),e.reject_blank==null&&(e.reject_blank=!0),e.skip_buttons==null&&(e.skip_buttons=!0),e.blanks===!1&&(e.reject_blank=!0),t=_(this.getFields()).inject(function(t,n){var r,i,s,o,u;return o=n.getValue(),i=n.input_name||n.name,u=!!_.str.isBlank(o)||!!_.isUndefined(o),r=!e.reject_blank&&!n.send_blanks,e.debug&&console.log(""+i+" Options",e,"Value",o,"Value Is Blank?",u,"Allow Blanks?",r),e.skip_buttons&&n.ctype==="button_field"?s=!0:(u&&r===!1&&(s=!0),n.input_name==="id"&&u===!0&&(s=!0)),e.debug&&console.log("Skip is true on "+i),s!==!0&&(t[i]=o),t},e.defaults||{}),t},submit_success_handler:function(e,t,n){return this.trigger("after:submit",this,e,t),this.loadMask===!0&&this.trigger("disable:loadmask",this),t&&(t!=null?t.success:void 0)===!0?this.trigger("after:submit:success",this,e,t):this.trigger("after:submit:error",this,e,t)},submit_fatal_error_handler:function(e,t,n){return this.trigger("after:submit",this,e,t),this.trigger("after:submit:fatal_error",this,e,t)},submit:function(e,t){e==null&&(e=!0),t==null&&(t={}),_.bindAll(this,"submit_success_handler","submit_fatal_error_handler"),t.success||(t.success=this.submit_success_handler),t.error||(t.error=this.submit_fatal_error_handler),this.syncFormWithModel();if(!e)return;return this.current_model.save(this.current_model.toJSON(),t)},hasModel:function(){return this.current_model!=null},currentModel:function(e){return e==null&&(e={}),(e===!0||(e!=null?e.refresh:void 0)===!0)&&this.syncFormWithModel(),this.current_model},syncFormWithModel:function(){var e;return(e=this.current_model)!=null?e.set(this.getValues()):void 0},setLegend:function(e){return this.legend=e,$("fieldset legend",this.el).first().html(this.legend)},flash:function(e){return this.$(".toolbar-container.top").length>0?this.$(".toolbar-container.top").after(e):this.$bodyEl().prepend(e)},successFlashDelay:1500,successMessage:function(e){var t=this;return this.$(".alert.alert-success").remove(),this.flash(Luca.template("components/form_alert",{className:"alert alert-success",message:e})),_.delay(function(){return t.$(".alert.alert-success").fadeOut()},this.successFlashDelay||0)},errorMessage:function(e){return this.$(".alert.alert-error").remove(),this.flash(Luca.template("components/form_alert",{className:"alert alert-error",message:e}))}}),Luca.components.FormView.defaultFormViewToolbar={buttons:[{icon:"remove-sign",label:"Reset",eventId:"click:reset",className:"reset-button",align:"right"},{icon:"ok-sign",white:!0,label:"Save Changes",eventId:"click:submit",color:"success",className:"submit-button",align:"right"}]}}.call(this),function(){_.def("Luca.components.GridView").extend("Luca.components.Panel")["with"]({bodyTemplate:"components/grid_view",autoBindEventHandlers:!0,events:{"dblclick table tbody tr":"double_click_handler","click table tbody tr":"click_handler"},className:"luca-ui-g-view",rowClass:"luca-ui-g-row",wrapperClass:"luca-ui-g-view-wrapper",additionalWrapperClasses:[],wrapperStyles:{},scrollable:!0,emptyText:"No Results To display.",tableStyle:"striped",defaultHeight:285,defaultWidth:756,maxWidth:void 0,hooks:["before:grid:render","before:render:header","before:render:row","after:grid:render","row:double:click","row:click","after:collection:load"],initialize:function(e){var t=this;return this.options=e!=null?e:{},_.extend(this,this.options),_.extend(this,Luca.modules.Deferrable),this.loadMask==null&&(this.loadMask=Luca.enableBootstrap),this.loadMask===!0&&(this.loadMaskEl||(this.loadMaskEl=".luca-ui-g-view-body")),Luca.components.Panel.prototype.initialize.apply(this,arguments),this.configure_collection(!0),this.collection.bind("before:fetch",function(){if(t.loadMask===!0)return t.trigger("enable:loadmask")}),this.collection.bind("reset",function(e){return t.refresh(),t.loadMask===!0&&t.trigger("disable:loadmask"),t.trigger("after:collection:load",e)}),this.collection.bind("change",function(e){var n,r;if(t.rendered!==!0)return;try{return r=t.getRowEl(e.id||e.get("id")||e.cid),n=t.render_row(e,t.collection.indexOf(e),{cellsOnly:!0}),$(r).html(n.join(" "))}catch(i){return console.log("Error in change handler for GridView.collection",i,t,e)}})},beforeRender:function(){var e;return(e=Luca.components.Panel.prototype.beforeRender)!=null&&e.apply(this,arguments),this.trigger("before:grid:render",this),this.table=this.$("table.luca-ui-g-view"),this.header=this.$("thead"),this.body=this.$("tbody"),this.footer=this.$("tfoot"),this.wrapper=this.$("."+this.wrapperClass),this.applyCssClasses(),this.scrollable&&this.setDimensions(),this.renderHeader(),this.emptyMessage(),$(this.container).append(this.$el)},afterRender:function(){var e;return(e=Luca.components.Panel.prototype.afterRender)!=null&&e.apply(this,arguments),this.rendered=!0,this.refresh(),this.trigger("after:grid:render",this)},applyCssClasses:function(){var e,t=this;return this.scrollable&&this.$el.addClass("scrollable-g-view"),_(this.additionalWrapperClasses).each(function(e){var n;return(n=t.wrapper)!=null?n.addClass(e):void 0}),Luca.enableBootstrap&&this.table.addClass("table"),_((e=this.tableStyle)!=null?e.split(" "):void 0).each(function(e){return t.table.addClass("table-"+e)})},setDimensions:function(e){var t=this;return this.height||(this.height=this.defaultHeight),this.$(".luca-ui-g-view-body").height(this.height),this.$("tbody.scrollable").height(this.height-23),this.container_width=function(){return $(t.container).width()}(),this.width||(this.width=this.container_width>0?this.container_width:this.defaultWidth),this.width=_([this.width,this.maxWidth||this.width]).max(),this.$(".luca-ui-g-view-body").width(this.width),this.$(".luca-ui-g-view-body table").width(this.width),this.setDefaultColumnWidths()},resize:function(e){var t,n,r=this;t=e-this.width,this.width=e,this.$(".luca-ui-g-view-body").width(this.width),this.$(".luca-ui-g-view-body table").width(this.width);if(this.columns.length>0)return n=t/this.columns.length,_(this.columns).each(function(e,t){var i;return i=$(".column-"+t,r.el),i.width(e.width=e.width+n)})},padLastColumn:function(){var e,t;e=_(this.columns).inject(function(e,t){return e=t.width+e},0),t=this.width-e;if(t>0)return this.lastColumn().width+=t},setDefaultColumnWidths:function(){var e;return e=this.columns.length>0?this.width/this.columns.length:200,_(this.columns).each(function(t){return parseInt(t.width||(t.width=e))}),this.padLastColumn()},lastColumn:function(){return this.columns[this.columns.length-1]},emptyMessage:function(e){return e==null&&(e=""),e||(e=this.emptyText),this.body.html(""),this.body.append(Luca.templates["components/grid_view_empty_text"]({colspan:this.columns.length,text:e}))},refresh:function(){var e=this;this.body.html(""),this.collection.each(function(t,n){return e.render_row.apply(e,[t,n])});if(this.collection.models.length===0)return this.emptyMessage()},ifLoaded:function(e,t){return t||(t=this),e||(e=function(){return!0}),this.collection.ifLoaded(e,t)},applyFilter:function(e,t){return t==null&&(t={auto:!0,refresh:!0}),this.collection.applyFilter(e,t)},renderHeader:function(){var e,t=this;return this.trigger("before:render:header"),e=_(this.columns).map(function(e,t){var n;return n=e.width?"width:"+e.width+"px;":"","<th style='"+n+"' class='column-"+t+"'>"+e.header+"</th>"}),this.header.append("<tr>"+e+"</tr>")},getRowEl:function(e){return this.$("[data-record-id="+e+"]","table")},render_row:function(e,t,n){var r,i,s,o,u,a,f=this;return n==null&&(n={}),u=this.rowClass,o=(e!=null?e.get:void 0)&&(e!=null?e.attributes:void 0)?e.get("id"):"",this.trigger("before:render:row",e,t),i=_(this.columns).map(function(t,n){var r,i,s;return s=f.cell_renderer(e,t,n),i=t.width?"width:"+t.width+"px;":"",r=_.isUndefined(s)?"":s,"<td style='"+i+"' class='column-"+n+"'>"+r+"</td>"}),n.cellsOnly?i:(r="",this.alternateRowClasses&&(r=t%2===0?"even":"odd"),s="<tr data-record-id='"+o+"' data-row-index='"+t+"' class='"+u+" "+r+"' id='row-"+t+"'>"+i+"</tr>",n.contentOnly===!0?s:(a=this.body)!=null?a.append(s):void 0)},cell_renderer:function(e,t,n){var r;return _.isFunction(t.renderer)?t.renderer.apply(this,[e,t,n]):t.data.match(/\w+\.\w+/)?(r=e.attributes||e,Luca.util.nestedValue(t.data,r)):(typeof e.get=="function"?e.get(t.data):void 0)||e[t.data]},double_click_handler:function(e){var t,n,r,i;return t=n=$(e.currentTarget),i=n.data("row-index"),r=this.collection.at(i),this.trigger("row:double:click",this,r,i)},click_handler:function(e){var t,n,r,i;return t=n=$(e.currentTarget),i=n.data("row-index"),r=this.collection.at(i),this.trigger("row:click",this,r,i),$("."+this.rowClass,this.body).removeClass("selected-row"),t.addClass("selected-row")}})}.call(this),function(){_.def("Luca.components.LoadMask")["extends"]("Luca.View")["with"]({className:"luca-ui-load-mask",bodyTemplate:"components/load_mask"})}.call(this),function(){var e,t,n;e=Luca.define("Luca.components.MultiCollectionView"),e["extends"]("Luca.containers.CardView"),e.behavesAs("LoadMaskable","Filterable","Paginatable"),e.triggers("before:refresh","after:refresh","refresh","empty:results"),e.defaultsTo({version:1,stateful:!0,defaultState:{activeView:0},viewContainerClass:"luca-ui-multi-view-container",initialize:function(e){var r,i,s,o;this.options=e!=null?e:{},this.components||(this.components=this.views),o=this.components;for(i=0,s=o.length;i<s;i++)r=o[i],n(r);return this.on("refresh",this.refresh,this),this.on("after:card:switch",this.refresh,this),this.on("after:components",t,this),this.debug("multi collection , proto initialize"),Luca.containers.CardView.prototype.initialize.apply(this,arguments)},relayAfterRefresh:function(e,t,n){return this.trigger("after:refresh",e,t,n)},refresh:function(){var e;return(e=this.activeComponent())!=null?e.trigger("refresh"):void 0},getCollection:function(){return this.collection},applyQuery:function(e,t){return e==null&&(e={}),t==null&&(t={}),this.query=e,this.queryOptions=t,this},getQuery:function(){var e,t,n,r,i;this.debug("Get Query"),e=this.query||(this.query={}),i=this.querySources;for(n=0,r=i.length;n<r;n++)t=i[n],e=_.extend(e,t()||{});return e},getQueryOptions:function(){var e,t,n,r,i;this.debug("Get Query Options"),t=this.queryOptions||(this.queryOptions={}),i=this.optionsSources;for(n=0,r=i.length;n<r;n++)e=i[n],t=_.extend(t,e()||{});return t}}),t=function(){var e,t,n,r,i,s,o=this;t=this,i=this.components,s=[];for(n=0,r=i.length;n<r;n++)e=i[n],e.on("after:refresh",function(e,t,n){return o.debug("collection member after refresh"),o.trigger("after:refresh",e,t,n)}),s.push(_.extend(e,{collection:t.getCollection(),getQuery:function(){return t.getQuery.call(t)},getQueryOptions:function(){return t.getQueryOptions.call(t)}}));return s},n=function(e){var t;t=e.type||e.ctype;if(t==="collection"||t==="collection_view"||t==="table"||t==="table_view")return;throw"The MultiCollectionView expects to contain multiple collection views"}}.call(this),function(){_.def("Luca.components.NavBar")["extends"]("Luca.View")["with"]({fixed:!0,position:"top",className:"navbar",brand:"Luca.js",bodyTemplate:"nav_bar",bodyClassName:"luca-ui-navbar-body",beforeRender:function(){this.fixed&&this.$el.addClass("navbar-fixed-"+this.position),this.brand!=null&&this.content().append("<a class='brand' href='#'>"+this.brand+"</a>");if(this.template)return this.content().append(Luca.template(this.template,this))},render:function(){return this},content:function(){return this.$(".container").eq(0)}})}.call(this),function(){_.def("Luca.PageController")["extends"]("Luca.components.Controller")["with"]({version:2})}.call(this),function(){var e;e=Luca.register("Luca.components.PaginationControl"),e["extends"]("Luca.View"),e.defines({template:"components/pagination",stateful:!0,autoBindEventHandlers:!0,events:{"click a[data-page-number]":"selectPage","click a.next":"nextPage","click a.prev":"previousPage"},afterInitialize:function(){var e=this;return _.bindAll(this,"updateWithPageCount"),this.state.on("change",function(t,n){return e.updateWithPageCount(t.get("numberOfPages"))})},limit:function(){var e;return parseInt(this.state.get("limit")||((e=this.collection)!=null?e.length:void 0))},page:function(){return parseInt(this.state.get("page")||1)},nextPage:function(){if(!this.nextEnabled())return;return this.state.set("page",this.page()+1)},previousPage:function(){if(!this.previousEnabled())return;return this.state.set("page",this.page()-1)},selectPage:function(e){var t,n;return t=n=this.$(e.target),t.is("a.page")||(t=n=n.closest("a.page")),n.siblings().removeClass("is-selected"),t.addClass("is-selected"),this.setPage(n.data("page-number"))},setPage:function(e,t){return e==null&&(e=1),t==null&&(t={}),this.state.set("page",e,t)},setLimit:function(e,t){return e==null&&(e=1),t==null&&(t={}),this.state.set("limit",e,t)},pageButtonContainer:function(){return this.$(".group")},previousEnabled:function(){return this.page()>1},nextEnabled:function(){return this.page()<this.totalPages()},previousButton:function(){return this.$("a.page.prev")},nextButton:function(){return this.$("a.page.next")},pageButtons:function(){return this.$("a[data-page-number]",this.pageButtonContainer())},updateWithPageCount:function(e,t){var n,r=this;return this.pageCount=e,t==null&&(t=[]),n=t.length,console.log("Update With Page Count",this.pageCount,n),this.pageButtonContainer().empty(),_(this.pageCount).times(function(e){var t,n;return n=e+1,t=r.make("a",{"data-page-number":n,"class":"page"},n),r.pageButtonContainer().append(t)}),this.toggleNavigationButtons(),this.selectActivePageButton(),this},toggleNavigationButtons:function(){this.$("a.next, a.prev").addClass("disabled"),this.nextEnabled()&&this.nextButton().removeClass("disabled");if(this.previousEnabled())return this.previousButton().removeClass("disabled")},selectActivePageButton:function(){return this.activePageButton().addClass("is-selected")},activePageButton:function(){return this.pageButtons().filter("[data-page-number='"+this.page()+"']")},totalPages:function(){return this.pageCount},totalItems:function(){var e;return parseInt(((e=this.collection)!=null?e.length:void 0)||0)},itemsPerPage:function(e,t){return t==null&&(t={}),e!=null&&this.state.set("limit",e,t),parseInt(this.state.get("limit"))}})}.call(this),function(){_.def("Luca.components.RecordManager")["extends"]("Luca.containers.CardView")["with"]({events:{"click .record-manager-grid .edit-link":"edit_handler","click .record-manager-filter .filter-button":"filter_handler","click .record-manager-filter .reset-button":"reset_filter_handler","click .add-button":"add_handler","click .refresh-button":"filter_handler","click .back-to-search-button":"back_to_search_handler"},record_manager:!0,initialize:function(e){var t=this;this.options=e!=null?e:{},Luca.containers.CardView.prototype.initialize.apply(this,arguments);if(!this.name)throw"Record Managers must specify a name";return _.bindAll(this,"add_handler","edit_handler","filter_handler","reset_filter_handler"),this.filterConfig&&_.extend(this.components[0][0],this.filterConfig),this.gridConfig&&_.extend(this.components[0][1],this.gridConfig),this.editorConfig&&_.extend(this.components[1][0],this.editorConfig),this.bind("after:card:switch",function(){t.activeCard===0&&t.trigger("activation:search",t);if(t.activeCard===1)return t.trigger("activation:editor",t)})},components:[{ctype:"split_view",relayFirstActivation:!0,components:[{ctype:"form_view"},{ctype:"grid_view"}]},{ctype:"form_view"}],getSearch:function(e,t){return e==null&&(e=!1),t==null&&(t=!0),e===!0&&this.activate(0),t===!0&&this.getEditor().clear(),_.first(this.components)},getFilter:function(){return _.first(this.getSearch().components)},getGrid:function(){return _.last(this.getSearch().components)},getCollection:function(){return this.getGrid().collection},getEditor:function(e,t){var n=this;return e==null&&(e=!1),t==null&&(t=!1),e===!0&&this.activate(1,function(e,t,n){return n.reset()}),_.last(this.components)},beforeRender:function(){var e;return this.$el.addClass(""+this.resource+"-manager"),(e=Luca.containers.CardView.prototype.beforeRender)!=null&&e.apply(this,arguments),this.$el.addClass(""+this.resource+" record-manager"),this.$el.data("resource",this.resource),$(this.getGrid().el).addClass(""+this.resource+" record-manager-grid"),$(this.getFilter().el).addClass(""+this.resource+" record-manager-filter"),$(this.getEditor().el).addClass(""+this.resource+" record-manager-editor")},afterRender:function(){var e,t,n,r,i,s,o=this;return(s=Luca.containers.CardView.prototype.afterRender)!=null&&s.apply(this,arguments),i=this,r=this.getGrid(),n=this.getFilter(),t=this.getEditor(),e=this.getCollection(),r.bind("row:double:click",function(e,n,r){return i.getEditor(!0),t.loadModel(n)}),t.bind("before:submit",function(){return $(".form-view-flash-container",o.el).html(""),$(".form-view-body",o.el).spin("large")}),t.bind("after:submit",function(){return $(".form-view-body",o.el).spin(!1)}),t.bind("after:submit:fatal_error",function(){return $(".form-view-flash-container",o.el).append("<li class='error'>There was an internal server error saving this record.  Please contact developers@benchprep.com to report this error.</li>"),$(".form-view-body",o.el).spin(!1)}),t.bind("after:submit:error",function(e,t,n){return _(n.errors).each(function(e){return $(".form-view-flash-container",o.el).append("<li class='error'>"+e+"</li>")})}),t.bind("after:submit:success",function(e,t,n){return $(".form-view-flash-container",o.el).append("<li class='success'>Successfully Saved Record</li>"),t.set(n.result),e.loadModel(t),r.refresh(),_.delay(function(){return $(".form-view-flash-container li.success",o.el).fadeOut(1e3),$(".form-view-flash-container",o.el).html("")},4e3)}),n.eachComponent(function(e){try{return e.bind("on:change",o.filter_handler)}catch(t){return}})},firstActivation:function(){return this.getGrid().trigger("first:activation",this,this.getGrid()),this.getFilter().trigger("first:activation",this,this.getGrid())},reload:function(){var e,t,n,r;return r=this,n=this.getGrid(),t=this.getFilter(),e=this.getEditor(),t.clear(),n.applyFilter()},manageRecord:function(e){var t,n=this;return t=this.getCollection().get(e),t?this.loadModel(t):(console.log("Could Not Find Model, building and fetching"),t=this.buildModel(),t.set({id:e},{silent:!0}),t.fetch({success:function(e,t){return n.loadModel(e)}}))},loadModel:function(e){return this.current_model=e,this.getEditor(!0).loadModel(this.current_model),this.trigger("model:loaded",this.current_model)},currentModel:function(){return this.getEditor(!1).currentModel()},buildModel:function(){var e,t,n;return t=this.getEditor(!1),e=this.getCollection(),e.add([{}],{silent:!0,at:0}),n=e.at(0)},createModel:function(){return this.loadModel(this.buildModel())},reset_filter_handler:function(e){return this.getFilter().clear(),this.getGrid().applyFilter(this.getFilter().getValues())},filter_handler:function(e){return this.getGrid().applyFilter(this.getFilter().getValues())},edit_handler:function(e){var t,n,r,i;return t=r=$(e.currentTarget),i=r.parents("tr").data("record-id"),i&&(n=this.getGrid().collection.get(i)),n||(n=this.getGrid().collection.at(row_index))},add_handler:function(e){var t,n,r;return t=n=$(e.currentTarget),r=n.parents(".record-manager").eq(0).data("resource")},destroy_handler:function(e){},back_to_search_handler:function(){}})}.call(this),function(){_.def("Luca.Router")["extends"]("Backbone.Router")["with"]({routes:{"":"default"},initialize:function(e){var t=this;return this.options=e,_.extend(this,this.options),this.routeHandlers=_(this.routes).values(),_(this.routeHandlers).each(function(e){return t.bind("route:"+e,function(){return t.trigger.apply(t,["change:navigation",e].concat(_(arguments).flatten()))})})},navigate:function(e,t){return t==null&&(t=!1),Backbone.Router.prototype.navigate.apply(this,arguments),this.buildPathFrom(Backbone.history.getFragment())},buildPathFrom:function(e){var t=this;return _(this.routes).each(function(n,r){var i,s;s=t._routeToRegExp(r);if(s.test(e))return i=t._extractParameters(s,e),t.trigger.apply(t,["change:navigation",n].concat(i))})}})}.call(this),function(){var e;_.def("Luca.components.TableView")["extends"]("Luca.components.CollectionView")["with"]({additionalClassNames:"table",tagName:"table",bodyTemplate:"table_view",bodyTagName:"tbody",bodyClassName:"table-body",itemTagName:"tr",stateful:!0,observeChanges:!0,columns:[],emptyText:"There are no results to display",itemRenderer:function(e,t){return Luca.components.TableView.rowRenderer.call(this,e,t)},initialize:function(e){var t,n=this;return this.options=e!=null?e:{},Luca.components.CollectionView.prototype.initialize.apply(this,arguments),this.columns=function(){var e,n,r,i;r=this.columns,i=[];for(e=0,n=r.length;e<n;e++)t=r[e],_.isString(t)&&(t={reader:t}),t.header==null&&(t.header=_.str.titleize(_.str.humanize(t.reader))),i.push(t);return i}.call(this),this.defer(function(){return Luca.components.TableView.renderHeader.call(n,n.columns,n.$("thead"))}).until("after:render")}}),e=Backbone.View.prototype.make,Luca.components.TableView.renderHeader=function(e,t){var n,r,i,s,o,u;i=0,r=function(){var t,r,s;s=[];for(t=0,r=e.length;t<r;t++)n=e[t],s.push("<th data-col-index='"+i++ +"'>"+n.header+"</th>");return s}(),this.$(t).append("<tr>"+r.join("")+"</tr>"),i=0,u=[];for(s=0,o=e.length;s<o;s++)n=e[s],n.width!=null&&u.push(this.$("th[data-col-index='"+i++ +"']",t).css("width",n.width));return u},Luca.components.TableView.rowRenderer=function(e,t,n){var r,i,s,o,u,a;r=0,u=this.columns,a=[];for(s=0,o=u.length;s<o;s++)i=u[s],a.push(Luca.components.TableView.renderColumn.call(this,i,e,t,r++));return a},Luca.components.TableView.renderColumn=function(t,n,r,i){var s;return s=r.read(t.reader),_.isFunction(t.renderer)&&(s=t.renderer.call(this,s,r,t)),e("td",{"data-col-index":i},s)}}.call(this),function(){_.def("Luca.components.ToolbarDialog")["extends"]("Luca.View")["with"]({className:"luca-ui-toolbar-dialog span well",styles:{position:"absolute","z-Index":"3000","float":"left"},initialize:function(e){return this.options=e!=null?e:{},this._super("initialize",this,arguments)},createWrapper:function(){return this.make("div",{"class":"component-picker span4 well",style:"position: absolute; z-index:12000"})},show:function(){return this.$el.parent().show()},hide:function(){return this.$el.parent().hide()},toggle:function(){return this.$el.parent().toggle()}})}.call(this),function(){}.call(this),function(){}.call(this);